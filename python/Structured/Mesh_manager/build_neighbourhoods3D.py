# Autogenerated with SMOP 
from smop.core import *
# 

    
@function
def build_neighbourhoods3D(N=None,Nx=None,Ny=None,Nz=None,periodicity=None,flagintbounds=None,indicesintbounds=None,typeintbounds=None,indicesbulk=None,indicesinternalbulk=None,indicesF1=None,indicesF2=None,indicesF3=None,indicesF4=None,indicesF5=None,indicesF6=None,indicesinternalF1=None,indicesinternalF2=None,indicesinternalF3=None,indicesinternalF4=None,indicesinternalF5=None,indicesinternalF6=None,indicesE1=None,indicesE2=None,indicesE3=None,indicesE4=None,indicesE5=None,indicesE6=None,indicesE7=None,indicesE8=None,indicesE9=None,indicesE10=None,indicesE11=None,indicesE12=None,indicesinternalE1=None,indicesinternalE2=None,indicesinternalE3=None,indicesinternalE4=None,indicesinternalE5=None,indicesinternalE6=None,indicesinternalE7=None,indicesinternalE8=None,indicesinternalE9=None,indicesinternalE10=None,indicesinternalE11=None,indicesinternalE12=None,indicesC1=None,indicesC2=None,indicesC3=None,indicesC4=None,indicesC5=None,indicesC6=None,indicesC7=None,indicesC8=None,indicesinternalC1=None,indicesinternalC2=None,indicesinternalC3=None,indicesinternalC4=None,indicesinternalC5=None,indicesinternalC6=None,indicesinternalC7=None,indicesinternalC8=None,*args,**kwargs):
    varargin = build_neighbourhoods3D.varargin
    nargin = build_neighbourhoods3D.nargin

    ##
#        Project: Fluid - structure interaction on deformable surfaces
#         Author: Luca Di Stasio
#    Institution: ETH Zrich
#                 Institute for Building Materials
# Research group: Computational Physics for Engineering Materials
#        Version: 0.1
#  Creation date: July 4th, 2014
#    Last update: July 25th, 2014
    
    #    Description: 
#          Input: 
#         Output:
    
    #                 Integer mask for periodicity:
#                 1  --> neighbour of F1 - F6
#                 2  --> neighbour of F2 - F4
#                 3  --> neighbour of F3 - F5
#                 4  --> neighbour of E1 - E11
#                 5  --> neighbour of E3 - E9
#                 6  --> neighbour of E2 - E12
#                 7  --> neighbour of E4 - E10
#                 8  --> neighbour of E6 - E8
#                 9  --> neighbour of E5 - E7
#                 10 --> neighbour of C1 - C7
#                 11 --> neighbour of C2 - C8
#                 12 --> neighbour of C3 - C5
#                 13 --> neighbour of C4 - C6
    
    #                 Integer mask for internal boundary topology:
#                 1   --> hole C1 
#                 2   --> hole C2
#                 3   --> hole C3
#                 4   --> hole C4
#                 5   --> hole C5 
#                 6   --> hole C6
#                 7   --> hole C7
#                 8   --> hole C8
#                 9   --> hole E1 
#                 10  --> hole E2
#                 11  --> hole E3
#                 12  --> hole E4
#                 13  --> hole E5 
#                 14  --> hole E6
#                 15  --> hole E7
#                 16  --> hole E8
#                 17  --> hole E9 
#                 18  --> hole E10
#                 19  --> hole E11
#                 20  --> hole E12
#                 21  --> F1
#                 22  --> F2
#                 23  --> F3
#                 24  --> F4
#                 25  --> F5
#                 26  --> F6
#                 27  --> C1 
#                 28  --> C2
#                 29  --> C3
#                 30  --> C4
#                 31  --> C5 
#                 32  --> C6
#                 33  --> C7
#                 34  --> C8
#                 35  --> E1 
#                 36  --> E2
#                 37  --> E3
#                 38  --> E4
#                 39  --> E5 
#                 40  --> E6
#                 41  --> E7
#                 42  --> E8
#                 43  --> E9 
#                 44  --> E10
#                 45  --> E11
#                 46  --> E12
    
    ##
    
    structuralneighbours=matlabarray(cat(zeros(N,1),dot(- 1,ones(N,6))))
    shearneighbours=matlabarray(cat(zeros(N,1),dot(- 1,ones(N,20))))
    bendneighbours=matlabarray(cat(zeros(N,1),dot(- 1,ones(N,6))))
    firstdevneighbours=zeros(N,12)
    # ---> structural neighbours
    
    structuralneighbours[indicesbulk,:]=cat(dot(6,ones(length(indicesbulk),1)),indicesbulk - 1,indicesbulk + 1,indicesbulk - Nx,indicesbulk + Nx,indicesbulk - dot(Nx,Ny),indicesbulk + dot(Nx,Ny))
    if any(periodicity == 1):
        structuralneighbours[indicesF1,:]=cat(dot(6,ones(length(indicesF1),1)),indicesF1 - 1,indicesF1 + 1,indicesF1 - Nx,indicesF1 + Nx,indicesF1 + dot(dot((Nz - 1),Nx),Ny),indicesF1 + dot(Nx,Ny))
        structuralneighbours[indicesF6,:]=cat(dot(6,ones(length(indicesF6),1)),indicesF6 - 1,indicesF6 + 1,indicesF6 - Nx,indicesF6 + Nx,indicesF6 - dot(Nx,Ny),indicesF6 - dot(dot((Nz - 1),Nx),Ny))
    else:
        structuralneighbours[indicesF1,:]=cat(dot(5,ones(length(indicesF1),1)),indicesF1 - 1,indicesF1 + 1,indicesF1 - Nx,indicesF1 + Nx,dot(- 1,ones(length(indicesF1),1)),indicesF1 + dot(Nx,Ny))
        structuralneighbours[indicesF6,:]=cat(dot(5,ones(length(indicesF6),1)),indicesF6 - 1,indicesF6 + 1,indicesF6 - Nx,indicesF6 + Nx,indicesF6 - dot(Nx,Ny),dot(- 1,ones(length(indicesF6),1)))
    
    if any(periodicity == 2):
        structuralneighbours[indicesF2,:]=cat(dot(6,ones(length(indicesF2),1)),indicesF2 - 1,indicesF2 + 1,indicesF2 + dot((Ny - 1),Nx),indicesF2 + Nx,indicesF2 - dot(Nx,Ny),indicesF2 + dot(Nx,Ny))
        structuralneighbours[indicesF4,:]=cat(dot(6,ones(length(indicesF4),1)),indicesF4 - 1,indicesF4 + 1,indicesF4 - Nx,indicesF4 - dot((Ny - 1),Nx),indicesF4 - dot(Nx,Ny),indicesF4 + dot(Nx,Ny))
    else:
        structuralneighbours[indicesF2,:]=cat(dot(5,ones(length(indicesF2),1)),indicesF2 - 1,indicesF2 + 1,dot(- 1,ones(length(indicesF2),1)),indicesF2 + Nx,indicesF2 - dot(Nx,Ny),indicesF2 + dot(Nx,Ny))
        structuralneighbours[indicesF4,:]=cat(dot(5,ones(length(indicesF4),1)),indicesF4 - 1,indicesF4 + 1,indicesF4 - Nx,dot(- 1,ones(length(indicesF4),1)),indicesF4 - dot(Nx,Ny),indicesF4 + dot(Nx,Ny))
    
    if any(periodicity == 3):
        structuralneighbours[indicesF3,:]=cat(dot(6,ones(length(indicesF3),1)),indicesF3 - 1,indicesF3 - (Nx - 1),indicesF3 - Nx,indicesF3 + Nx,indicesF3 - dot(Nx,Ny),indicesF3 + dot(Nx,Ny))
        structuralneighbours[indicesF5,:]=cat(dot(6,ones(length(indicesF5),1)),indicesF5 + (Nx - 1),indicesF5 + 1,indicesF5 - Nx,indicesF5 + Nx,indicesF5 - dot(Nx,Ny),indicesF5 + dot(Nx,Ny))
    else:
        structuralneighbours[indicesF3,:]=cat(dot(5,ones(length(indicesF3),1)),indicesF3 - 1,dot(- 1,ones(length(indicesF3),1)),indicesF3 - Nx,indicesF3 + Nx,indicesF3 - dot(Nx,Ny),indicesF3 + dot(Nx,Ny))
        structuralneighbours[indicesF5,:]=cat(dot(5,ones(length(indicesF5),1)),dot(- 1,ones(length(indicesF5),1)),indicesF5 + 1,indicesF5 - Nx,indicesF5 + Nx,indicesF5 - dot(Nx,Ny),indicesF5 + dot(Nx,Ny))
    
    if any(periodicity == 1) and any(periodicity == 2) and any(periodicity == 3):
        structuralneighbours[indicesE1,:]=cat(dot(4,ones(length(indicesE1),1)),indicesE1 - 1,indicesE1 + 1,indicesE1 + dot((Ny - 1),Nx),indicesE1 + Nx,indicesE1 + dot(dot((Nz - 1),Nx),Ny),indicesE1 + dot(Nx,Ny))
        structuralneighbours[indicesE2,:]=cat(dot(4,ones(length(indicesE2),1)),indicesE2 - 1,indicesE2 - (Nx - 1),indicesE2 - Nx,indicesE2 + Nx,indicesE2 + dot(dot((Nz - 1),Nx),Ny),indicesE2 + dot(Nx,Ny))
        structuralneighbours[indicesE3,:]=cat(dot(4,ones(length(indicesE3),1)),indicesE3 - 1,indicesE3 + 1,indicesE3 - Nx,indicesE3 - dot((Ny - 1),Nx),indicesE3 + dot(dot((Nz - 1),Nx),Ny),indicesE3 + dot(Nx,Ny))
        structuralneighbours[indicesE4,:]=cat(dot(4,ones(length(indicesE4),1)),indicesE4 + (Nx - 1),indicesE4 + 1,indicesE4 - Nx,indicesE4 + Nx,indicesE4 + dot(dot((Nz - 1),Nx),Ny),indicesE4 + dot(Nx,Ny))
        structuralneighbours[indicesE5,:]=cat(dot(4,ones(length(indicesE5),1)),indicesE5 + (Nx - 1),indicesE5 + 1,indicesE5 + dot((Ny - 1),Nx),indicesE5 + Nx,indicesE5 - dot(Nx,Ny),indicesE5 + dot(Nx,Ny))
        structuralneighbours[indicesE6,:]=cat(dot(4,ones(length(indicesE6),1)),indicesE6 - 1,indicesE6 - (Nx - 1),indicesE6 + dot((Ny - 1),Nx),indicesE6 + Nx,indicesE6 - dot(Nx,Ny),indicesE6 + dot(Nx,Ny))
        structuralneighbours[indicesE7,:]=cat(dot(4,ones(length(indicesE7),1)),indicesE7 - 1,indicesE7 - (Nx - 1),indicesE7 - Nx,indicesE7 - dot((Ny - 1),Nx),indicesE7 - dot(Nx,Ny),indicesE7 + dot(Nx,Ny))
        structuralneighbours[indicesE8,:]=cat(dot(4,ones(length(indicesE8),1)),indicesE8 + (Nx - 1),indicesE8 + 1,indicesE8 - Nx,indicesE8 - dot((Ny - 1),Nx),indicesE8 - dot(Nx,Ny),indicesE8 + dot(Nx,Ny))
        structuralneighbours[indicesE9,:]=cat(dot(4,ones(length(indicesE9),1)),indicesE9 - 1,indicesE9 + 1,indicesE9 + dot((Ny - 1),Nx),indicesE9 + Nx,indicesE9 - dot(Nx,Ny),indicesE9 - dot(dot((Nz - 1),Nx),Ny))
        structuralneighbours[indicesE10,:]=cat(dot(4,ones(length(indicesE10),1)),indicesE10 - 1,indicesE10 - (Nx - 1),indicesE10 - Nx,indicesE10 + Nx,indicesE10 - dot(Nx,Ny),indicesE10 - dot(dot((Nz - 1),Nx),Ny))
        structuralneighbours[indicesE11,:]=cat(dot(4,ones(length(indicesE11),1)),indicesE11 - 1,indicesE11 + 1,indicesE11 - Nx,indicesE11 - dot((Ny - 1),Nx),indicesE11 - dot(Nx,Ny),indicesE11 - dot(dot((Nz - 1),Nx),Ny))
        structuralneighbours[indicesE12,:]=cat(dot(4,ones(length(indicesE12),1)),indicesE12 + (Nx - 1),indicesE12 + 1,indicesE12 - Nx,indicesE12 + Nx,indicesE12 - dot(Nx,Ny),indicesE12 - dot(dot((Nz - 1),Nx),Ny))
        structuralneighbours[indicesC1,:]=cat(dot(3,ones(length(indicesC1),1)),indicesC1 + (Nx - 1),indicesC1 + 1,indicesC1 + dot((Ny - 1),Nx),indicesC1 + Nx,indicesC1 + dot(dot((Nz - 1),Nx),Ny),indicesC1 + dot(Nx,Ny))
        structuralneighbours[indicesC2,:]=cat(dot(3,ones(length(indicesC2),1)),indicesC2 - 1,indicesC2 - (Nx - 1),indicesC2 + dot((Ny - 1),Nx),indicesC2 + Nx,indicesC2 + dot(dot((Nz - 1),Nx),Ny),indicesC2 + dot(Nx,Ny))
        structuralneighbours[indicesC3,:]=cat(dot(3,ones(length(indicesC3),1)),indicesC3 - 1,indicesC3 - (Nx - 1),indicesC3 - Nx,indicesC3 - dot((Ny - 1),Nx),indicesC3 + dot(dot((Nz - 1),Nx),Ny),indicesC3 + dot(Nx,Ny))
        structuralneighbours[indicesC4,:]=cat(dot(3,ones(length(indicesC4),1)),indicesC4 + (Nx - 1),indicesC4 + 1,indicesC4 - Nx,indicesC4 - dot((Ny - 1),Nx),indicesC4 + dot(dot((Nz - 1),Nx),Ny),indicesC4 + dot(Nx,Ny))
        structuralneighbours[indicesC5,:]=cat(dot(3,ones(length(indicesC5),1)),indicesC5 + (Nx - 1),indicesC5 + 1,indicesC5 + dot((Ny - 1),Nx),indicesC5 + Nx,indicesC5 - dot(Nx,Ny),indicesC5 - dot(dot((Nz - 1),Nx),Ny))
        structuralneighbours[indicesC6,:]=cat(dot(3,ones(length(indicesC6),1)),indicesC6 - 1,indicesC6 - (Nx - 1),indicesC6 + dot((Ny - 1),Nx),indicesC6 + Nx,indicesC6 - dot(Nx,Ny),indicesC6 - dot(dot((Nz - 1),Nx),Ny))
        structuralneighbours[indicesC7,:]=cat(dot(3,ones(length(indicesC7),1)),indicesC7 - 1,indicesC7 - (Nx - 1),indicesC7 - Nx,indicesC7 - dot((Ny - 1),Nx),indicesC7 - dot(Nx,Ny),indicesC7 - dot(dot((Nz - 1),Nx),Ny))
        structuralneighbours[indicesC8,:]=cat(dot(3,ones(length(indicesC8),1)),indicesC8 + (Nx - 1),indicesC8 + 1,indicesC8 - Nx,indicesC8 - dot((Ny - 1),Nx),indicesC8 - dot(Nx,Ny),indicesC8 - dot(dot((Nz - 1),Nx),Ny))
    else:
        structuralneighbours[indicesE1,:]=cat(dot(4,ones(length(indicesE1),1)),indicesE1 - 1,indicesE1 + 1,dot(- 1,ones(length(indicesE1),1)),indicesE1 + Nx,dot(- 1,ones(length(indicesE1),1)),indicesE1 + dot(Nx,Ny))
        structuralneighbours[indicesE2,:]=cat(dot(4,ones(length(indicesE2),1)),indicesE2 - 1,dot(- 1,ones(length(indicesE2),1)),indicesE2 - Nx,indicesE2 + Nx,dot(- 1,ones(length(indicesE2),1)),indicesE2 + dot(Nx,Ny))
        structuralneighbours[indicesE3,:]=cat(dot(4,ones(length(indicesE3),1)),indicesE3 - 1,indicesE3 + 1,indicesE3 - Nx,dot(- 1,ones(length(indicesE3),1)),dot(- 1,ones(length(indicesE3),1)),indicesE3 + dot(Nx,Ny))
        structuralneighbours[indicesE4,:]=cat(dot(4,ones(length(indicesE4),1)),dot(- 1,ones(length(indicesE4),1)),indicesE4 + 1,indicesE4 - Nx,indicesE4 + Nx,dot(- 1,ones(length(indicesE4),1)),indicesE4 + dot(Nx,Ny))
        structuralneighbours[indicesE5,:]=cat(dot(4,ones(length(indicesE5),1)),dot(- 1,ones(length(indicesE5),1)),indicesE5 + 1,dot(- 1,ones(length(indicesE5),1)),indicesE5 + Nx,indicesE5 - dot(Nx,Ny),indicesE5 + dot(Nx,Ny))
        structuralneighbours[indicesE6,:]=cat(dot(4,ones(length(indicesE6),1)),indicesE6 - 1,dot(- 1,ones(length(indicesE6),1)),dot(- 1,ones(length(indicesE6),1)),indicesE6 + Nx,indicesE6 - dot(Nx,Ny),indicesE6 + dot(Nx,Ny))
        structuralneighbours[indicesE7,:]=cat(dot(4,ones(length(indicesE7),1)),indicesE7 - 1,dot(- 1,ones(length(indicesE7),1)),indicesE7 - Nx,dot(- 1,ones(length(indicesE7),1)),indicesE7 - dot(Nx,Ny),indicesE7 + dot(Nx,Ny))
        structuralneighbours[indicesE8,:]=cat(dot(4,ones(length(indicesE8),1)),dot(- 1,ones(length(indicesE8),1)),indicesE8 + 1,indicesE8 - Nx,dot(- 1,ones(length(indicesE8),1)),indicesE8 - dot(Nx,Ny),indicesE8 + dot(Nx,Ny))
        structuralneighbours[indicesE9,:]=cat(dot(4,ones(length(indicesE9),1)),indicesE9 - 1,indicesE9 + 1,dot(- 1,ones(length(indicesE9),1)),indicesE9 + Nx,indicesE9 - dot(Nx,Ny),dot(- 1,ones(length(indicesE9),1)))
        structuralneighbours[indicesE10,:]=cat(dot(4,ones(length(indicesE10),1)),indicesE10 - 1,dot(- 1,ones(length(indicesE10),1)),indicesE10 - Nx,indicesE10 + Nx,indicesE10 - dot(Nx,Ny),dot(- 1,ones(length(indicesE10),1)))
        structuralneighbours[indicesE11,:]=cat(dot(4,ones(length(indicesE11),1)),indicesE11 - 1,indicesE11 + 1,indicesE11 - Nx,dot(- 1,ones(length(indicesE11),1)),indicesE11 - dot(Nx,Ny),dot(- 1,ones(length(indicesE11),1)))
        structuralneighbours[indicesE12,:]=cat(dot(4,ones(length(indicesE12),1)),dot(- 1,ones(length(indicesE12),1)),indicesE12 + 1,indicesE12 - Nx,indicesE12 + Nx,indicesE12 - dot(Nx,Ny),dot(- 1,ones(length(indicesE12),1)))
        structuralneighbours[indicesC1,:]=cat(dot(3,ones(length(indicesC1),1)),dot(- 1,ones(length(indicesC1),1)),indicesC1 + 1,dot(- 1,ones(length(indicesC1),1)),indicesC1 + Nx,dot(- 1,ones(length(indicesC1),1)),indicesC1 + dot(Nx,Ny))
        structuralneighbours[indicesC2,:]=cat(dot(3,ones(length(indicesC2),1)),indicesC2 - 1,dot(- 1,ones(length(indicesC2),1)),dot(- 1,ones(length(indicesC2),1)),indicesC2 + Nx,dot(- 1,ones(length(indicesC2),1)),indicesC2 + dot(Nx,Ny))
        structuralneighbours[indicesC3,:]=cat(dot(3,ones(length(indicesC3),1)),indicesC3 - 1,dot(- 1,ones(length(indicesC3),1)),indicesC3 - Nx,dot(- 1,ones(length(indicesC3),1)),dot(- 1,ones(length(indicesC3),1)),indicesC3 + dot(Nx,Ny))
        structuralneighbours[indicesC4,:]=cat(dot(3,ones(length(indicesC4),1)),dot(- 1,ones(length(indicesC4),1)),indicesC4 + 1,indicesC4 - Nx,dot(- 1,ones(length(indicesC4),1)),dot(- 1,ones(length(indicesC4),1)),indicesC4 + dot(Nx,Ny))
        structuralneighbours[indicesC5,:]=cat(dot(3,ones(length(indicesC5),1)),dot(- 1,ones(length(indicesC5),1)),indicesC5 + 1,dot(- 1,ones(length(indicesC5),1)),indicesC5 + Nx,indicesC5 - dot(Nx,Ny),dot(- 1,ones(length(indicesC5),1)))
        structuralneighbours[indicesC6,:]=cat(dot(3,ones(length(indicesC6),1)),indicesC6 - 1,dot(- 1,ones(length(indicesC6),1)),dot(- 1,ones(length(indicesC6),1)),indicesC6 + Nx,indicesC6 - dot(Nx,Ny),dot(- 1,ones(length(indicesC6),1)))
        structuralneighbours[indicesC7,:]=cat(dot(3,ones(length(indicesC7),1)),indicesC7 - 1,dot(- 1,ones(length(indicesC7),1)),indicesC7 - Nx,dot(- 1,ones(length(indicesC7),1)),indicesC7 - dot(Nx,Ny),dot(- 1,ones(length(indicesC7),1)))
        structuralneighbours[indicesC8,:]=cat(dot(3,ones(length(indicesC8),1)),dot(- 1,ones(length(indicesC8),1)),indicesC8 + 1,indicesC8 - Nx,dot(- 1,ones(length(indicesC8),1)),indicesC8 - dot(Nx,Ny),dot(- 1,ones(length(indicesC8),1)))
    
    if flagintbounds:
        for i in arange(1,size(indicesintbounds,1)).reshape(-1):
            index=indicesintbounds[i,1]
            if 1 == typeintbounds[i,1]:
                structuralneighbours[index,:]=cat(6,index - 1,index + 1,index - Nx,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
            else:
                if 2 == typeintbounds[i,1]:
                    structuralneighbours[index,:]=cat(6,index - 1,index + 1,index - Nx,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
                else:
                    if 3 == typeintbounds[i,1]:
                        structuralneighbours[index,:]=cat(6,index - 1,index + 1,index - Nx,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
                    else:
                        if 4 == typeintbounds[i,1]:
                            structuralneighbours[index,:]=cat(6,index - 1,index + 1,index - Nx,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
                        else:
                            if 5 == typeintbounds[i,1]:
                                structuralneighbours[index,:]=cat(6,index - 1,index + 1,index - Nx,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
                            else:
                                if 6 == typeintbounds[i,1]:
                                    structuralneighbours[index,:]=cat(6,index - 1,index + 1,index - Nx,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
                                else:
                                    if 7 == typeintbounds[i,1]:
                                        structuralneighbours[index,:]=cat(6,index - 1,index + 1,index - Nx,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
                                    else:
                                        if 8 == typeintbounds[i,1]:
                                            structuralneighbours[index,:]=cat(6,index - 1,index + 1,index - Nx,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
                                        else:
                                            if 9 == typeintbounds[i,1]:
                                                structuralneighbours[index,:]=cat(6,index - 1,index + 1,index - Nx,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
                                            else:
                                                if 10 == typeintbounds[i,1]:
                                                    structuralneighbours[index,:]=cat(6,index - 1,index + 1,index - Nx,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
                                                else:
                                                    if 11 == typeintbounds[i,1]:
                                                        structuralneighbours[index,:]=cat(6,index - 1,index + 1,index - Nx,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
                                                    else:
                                                        if 12 == typeintbounds[i,1]:
                                                            structuralneighbours[index,:]=cat(6,index - 1,index + 1,index - Nx,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
                                                        else:
                                                            if 13 == typeintbounds[i,1]:
                                                                structuralneighbours[index,:]=cat(6,index - 1,index + 1,index - Nx,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
                                                            else:
                                                                if 14 == typeintbounds[i,1]:
                                                                    structuralneighbours[index,:]=cat(6,index - 1,index + 1,index - Nx,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
                                                                else:
                                                                    if 15 == typeintbounds[i,1]:
                                                                        structuralneighbours[index,:]=cat(6,index - 1,index + 1,index - Nx,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
                                                                    else:
                                                                        if 16 == typeintbounds[i,1]:
                                                                            structuralneighbours[index,:]=cat(6,index - 1,index + 1,index - Nx,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
                                                                        else:
                                                                            if 17 == typeintbounds[i,1]:
                                                                                structuralneighbours[index,:]=cat(6,index - 1,index + 1,index - Nx,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
                                                                            else:
                                                                                if 18 == typeintbounds[i,1]:
                                                                                    structuralneighbours[index,:]=cat(6,index - 1,index + 1,index - Nx,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
                                                                                else:
                                                                                    if 19 == typeintbounds[i,1]:
                                                                                        structuralneighbours[index,:]=cat(6,index - 1,index + 1,index - Nx,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
                                                                                    else:
                                                                                        if 20 == typeintbounds[i,1]:
                                                                                            structuralneighbours[index,:]=cat(6,index - 1,index + 1,index - Nx,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
                                                                                        else:
                                                                                            if 21 == typeintbounds[i,1]:
                                                                                                structuralneighbours[index,:]=cat(5,index - 1,index + 1,index - Nx,index + Nx,- 1,index + dot(Nx,Ny))
                                                                                            else:
                                                                                                if 22 == typeintbounds[i,1]:
                                                                                                    structuralneighbours[index,:]=cat(5,index - 1,index + 1,- 1,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
                                                                                                else:
                                                                                                    if 23 == typeintbounds[i,1]:
                                                                                                        structuralneighbours[index,:]=cat(5,index - 1,- 1,index - Nx,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
                                                                                                    else:
                                                                                                        if 24 == typeintbounds[i,1]:
                                                                                                            structuralneighbours[index,:]=cat(5,index - 1,index + 1,index - Nx,- 1,index - dot(Nx,Ny),index + dot(Nx,Ny))
                                                                                                        else:
                                                                                                            if 25 == typeintbounds[i,1]:
                                                                                                                structuralneighbours[index,:]=cat(5,- 1,index + 1,index - Nx,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
                                                                                                            else:
                                                                                                                if 26 == typeintbounds[i,1]:
                                                                                                                    structuralneighbours[index,:]=cat(5,index - 1,index + 1,index - Nx,index + Nx,index - dot(Nx,Ny),- 1)
                                                                                                                else:
                                                                                                                    if 27 == typeintbounds[i,1]:
                                                                                                                        structuralneighbours[index,:]=cat(3,- 1,index + 1,- 1,index + Nx,- 1,index + dot(Nx,Ny))
                                                                                                                    else:
                                                                                                                        if 28 == typeintbounds[i,1]:
                                                                                                                            structuralneighbours[index,:]=cat(3,index - 1,- 1,- 1,index + Nx,- 1,index + dot(Nx,Ny))
                                                                                                                        else:
                                                                                                                            if 29 == typeintbounds[i,1]:
                                                                                                                                structuralneighbours[index,:]=cat(3,index - 1,- 1,index - Nx,- 1,- 1,index + dot(Nx,Ny))
                                                                                                                            else:
                                                                                                                                if 30 == typeintbounds[i,1]:
                                                                                                                                    structuralneighbours[index,:]=cat(3,- 1,index + 1,index - Nx,- 1,- 1,index + dot(Nx,Ny))
                                                                                                                                else:
                                                                                                                                    if 31 == typeintbounds[i,1]:
                                                                                                                                        structuralneighbours[index,:]=cat(3,- 1,index + 1,- 1,index + Nx,index - dot(Nx,Ny),- 1)
                                                                                                                                    else:
                                                                                                                                        if 32 == typeintbounds[i,1]:
                                                                                                                                            structuralneighbours[index,:]=cat(3,index - 1,- 1,- 1,index + Nx,index - dot(Nx,Ny),- 1)
                                                                                                                                        else:
                                                                                                                                            if 33 == typeintbounds[i,1]:
                                                                                                                                                structuralneighbours[index,:]=cat(3,index - 1,- 1,index - Nx,- 1,index - dot(Nx,Ny),- 1)
                                                                                                                                            else:
                                                                                                                                                if 34 == typeintbounds[i,1]:
                                                                                                                                                    structuralneighbours[index,:]=cat(3,- 1,index + 1,index - Nx,- 1,index - dot(Nx,Ny),- 1)
                                                                                                                                                else:
                                                                                                                                                    if 35 == typeintbounds[i,1]:
                                                                                                                                                        structuralneighbours[index,:]=cat(4,index - 1,index + 1,- 1,index + Nx,- 1,index + dot(Nx,Ny))
                                                                                                                                                    else:
                                                                                                                                                        if 36 == typeintbounds[i,1]:
                                                                                                                                                            structuralneighbours[index,:]=cat(4,index - 1,- 1,index - Nx,index + Nx,- 1,index + dot(Nx,Ny))
                                                                                                                                                        else:
                                                                                                                                                            if 37 == typeintbounds[i,1]:
                                                                                                                                                                structuralneighbours[index,:]=cat(4,index - 1,index + 1,index - Nx,- 1,- 1,index + dot(Nx,Ny))
                                                                                                                                                            else:
                                                                                                                                                                if 38 == typeintbounds[i,1]:
                                                                                                                                                                    structuralneighbours[index,:]=cat(4,- 1,index + 1,index - Nx,index + Nx,- 1,index + dot(Nx,Ny))
                                                                                                                                                                else:
                                                                                                                                                                    if 39 == typeintbounds[i,1]:
                                                                                                                                                                        structuralneighbours[index,:]=cat(4,- 1,index + 1,- 1,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
                                                                                                                                                                    else:
                                                                                                                                                                        if 40 == typeintbounds[i,1]:
                                                                                                                                                                            structuralneighbours[index,:]=cat(4,index - 1,- 1,- 1,index + Nx,index - dot(Nx,Ny),index + dot(Nx,Ny))
                                                                                                                                                                        else:
                                                                                                                                                                            if 41 == typeintbounds[i,1]:
                                                                                                                                                                                structuralneighbours[index,:]=cat(4,index - 1,- 1,index - Nx,- 1,index - dot(Nx,Ny),index + dot(Nx,Ny))
                                                                                                                                                                            else:
                                                                                                                                                                                if 42 == typeintbounds[i,1]:
                                                                                                                                                                                    structuralneighbours[index,:]=cat(4,- 1,index + 1,index - Nx,- 1,index - dot(Nx,Ny),index + dot(Nx,Ny))
                                                                                                                                                                                else:
                                                                                                                                                                                    if 43 == typeintbounds[i,1]:
                                                                                                                                                                                        structuralneighbours[index,:]=cat(4,index - 1,index + 1,- 1,index + Nx,index - dot(Nx,Ny),- 1)
                                                                                                                                                                                    else:
                                                                                                                                                                                        if 44 == typeintbounds[i,1]:
                                                                                                                                                                                            structuralneighbours[index,:]=cat(4,index - 1,- 1,index - Nx,index + Nx,index - dot(Nx,Ny),- 1)
                                                                                                                                                                                        else:
                                                                                                                                                                                            if 45 == typeintbounds[i,1]:
                                                                                                                                                                                                structuralneighbours[index,:]=cat(4,index - 1,index + 1,index - Nx,- 1,index - dot(Nx,Ny),- 1)
                                                                                                                                                                                            else:
                                                                                                                                                                                                if 46 == typeintbounds[i,1]:
                                                                                                                                                                                                    structuralneighbours[index,:]=cat(4,- 1,index + 1,index - Nx,index + Nx,index - dot(Nx,Ny),- 1)
    
    # ---> shear neighbours
    
    A=- 1 - Nx - dot(Nx,Ny)
    B=- Nx - dot(Nx,Ny)
    C=+ 1 - Nx - dot(Nx,Ny)
    D=- 1 - dot(Nx,Ny)
    E=+ 1 - dot(Nx,Ny)
    F=- 1 + Nx - dot(Nx,Ny)
    G=+ Nx - dot(Nx,Ny)
    H=+ 1 + Nx - dot(Nx,Ny)
    I=- 1 - Nx
    L=+ 1 - Nx
    M=- 1 + Nx
    N=+ 1 + Nx
    O=- 1 - Nx + dot(Nx,Ny)
    P=- Nx + dot(Nx,Ny)
    Q=+ 1 - Nx + dot(Nx,Ny)
    R=- 1 + dot(Nx,Ny)
    S=+ 1 + dot(Nx,Ny)
    T=- 1 + Nx + dot(Nx,Ny)
    U=+ Nx + dot(Nx,Ny)
    V=+ 1 + Nx + dot(Nx,Ny)
    shearneighbours[indicesbulk,:]=cat(dot(20,ones(length(indicesbulk),1)),indicesbulk + A,indicesbulk + B,indicesbulk + C,indicesbulk + D,indicesbulk + E,indicesbulk + F,indicesbulk + G,indicesbulk + H,indicesbulk + I,indicesbulk + L,indicesbulk + M,indicesbulk + N,indicesbulk + O,indicesbulk + P,indicesbulk + Q,indicesbulk + R,indicesbulk + S,indicesbulk + T,indicesbulk + U,indicesbulk + V)
    shearneighbours[indicesF1,:]=cat(dot(12,ones(length(indicesF1),1)),dot(- 1,ones(length(indicesF1),1)),dot(- 1,ones(length(indicesF1),1)),dot(- 1,ones(length(indicesF1),1)),dot(- 1,ones(length(indicesF1),1)),dot(- 1,ones(length(indicesF1),1)),dot(- 1,ones(length(indicesF1),1)),dot(- 1,ones(length(indicesF1),1)),dot(- 1,ones(length(indicesF1),1)),indicesF1 + I,indicesF1 + L,indicesF1 + M,indicesF1 + N,indicesF1 + O,indicesF1 + P,indicesF1 + Q,indicesF1 + R,indicesF1 + S,indicesF1 + T,indicesF1 + U,indicesF1 + V)
    shearneighbours[indicesF2,:]=cat(dot(12,ones(length(indicesF2),1)),dot(- 1,ones(length(indicesF2),1)),dot(- 1,ones(length(indicesF2),1)),dot(- 1,ones(length(indicesF2),1)),indicesF2 + D,indicesF2 + E,indicesF2 + F,indicesF2 + G,indicesF2 + H,dot(- 1,ones(length(indicesF2),1)),dot(- 1,ones(length(indicesF2),1)),indicesF2 + M,indicesF2 + N,dot(- 1,ones(length(indicesF2),1)),dot(- 1,ones(length(indicesF2),1)),dot(- 1,ones(length(indicesF2),1)),indicesF2 + R,indicesF2 + S,indicesF2 + T,indicesF2 + U,indicesF2 + V)
    shearneighbours[indicesF3,:]=cat(dot(12,ones(length(indicesF3),1)),indicesF3 + A,indicesF3 + B,dot(- 1,ones(length(indicesF3),1)),indicesF3 + D,dot(- 1,ones(length(indicesF3),1)),indicesF3 + F,indicesF3 + G,dot(- 1,ones(length(indicesF3),1)),indicesF3 + I,dot(- 1,ones(length(indicesF3),1)),indicesF3 + M,dot(- 1,ones(length(indicesF3),1)),indicesF3 + O,indicesF3 + P,dot(- 1,ones(length(indicesF3),1)),indicesF3 + R,dot(- 1,ones(length(indicesF3),1)),indicesF3 + T,indicesF3 + U,dot(- 1,ones(length(indicesF3),1)))
    shearneighbours[indicesF4,:]=cat(dot(12,ones(length(indicesF4),1)),indicesF4 + A,indicesF4 + B,indicesF4 + C,indicesF4 + D,indicesF4 + E,dot(- 1,ones(length(indicesF4),1)),dot(- 1,ones(length(indicesF4),1)),dot(- 1,ones(length(indicesF4),1)),indicesF4 + I,indicesF4 + L,dot(- 1,ones(length(indicesF4),1)),dot(- 1,ones(length(indicesF4),1)),indicesF4 + O,indicesF4 + P,indicesF4 + Q,indicesF4 + R,indicesF4 + S,dot(- 1,ones(length(indicesF4),1)),dot(- 1,ones(length(indicesF4),1)),dot(- 1,ones(length(indicesF4),1)))
    shearneighbours[indicesF5,:]=cat(dot(12,ones(length(indicesF5),1)),dot(- 1,ones(length(indicesF5),1)),indicesF5 + B,indicesF5 + C,dot(- 1,ones(length(indicesF5),1)),indicesF5 + E,dot(- 1,ones(length(indicesF5),1)),indicesF5 + G,indicesF5 + H,dot(- 1,ones(length(indicesF5),1)),indicesF5 + L,dot(- 1,ones(length(indicesF5),1)),indicesF5 + N,dot(- 1,ones(length(indicesF5),1)),indicesF5 + P,indicesF5 + Q,dot(- 1,ones(length(indicesF5),1)),indicesF5 + S,dot(- 1,ones(length(indicesF5),1)),indicesF5 + U,indicesF5 + V)
    shearneighbours[indicesF6,:]=cat(dot(12,ones(length(indicesF6),1)),indicesF6 + A,indicesF6 + B,indicesF6 + C,indicesF6 + D,indicesF6 + E,indicesF6 + F,indicesF6 + G,indicesF6 + H,indicesF6 + I,indicesF6 + L,indicesF6 + M,indicesF6 + N,dot(- 1,ones(length(indicesF6),1)),dot(- 1,ones(length(indicesF6),1)),dot(- 1,ones(length(indicesF6),1)),dot(- 1,ones(length(indicesF6),1)),dot(- 1,ones(length(indicesF6),1)),dot(- 1,ones(length(indicesF6),1)),dot(- 1,ones(length(indicesF6),1)),dot(- 1,ones(length(indicesF6),1)))
    shearneighbours[indicesE1,:]=cat(dot(7,ones(length(indicesE1),1)),dot(- 1,ones(length(indicesE1),10)),indicesE1 + M,indicesE1 + N,dot(- 1,ones(length(indicesE1),3)),indicesE1 + R,indicesE1 + S,indicesE1 + T,indicesE1 + U,indicesE1 + V)
    shearneighbours[indicesE2,:]=cat(dot(7,ones(length(indicesE2),1)),dot(- 1,ones(length(indicesE2),8)),indicesE2 + I,dot(- 1,ones(length(indicesE2),1)),indicesE2 + M,dot(- 1,ones(length(indicesE2),1)),indicesE2 + O,indicesE2 + P,dot(- 1,ones(length(indicesE2),1)),indicesE2 + R,dot(- 1,ones(length(indicesE2),1)),indicesE2 + T,indicesE2 + U,dot(- 1,ones(length(indicesE2),1)))
    shearneighbours[indicesE3,:]=cat(dot(7,ones(length(indicesE3),1)),dot(- 1,ones(length(indicesE3),8)),indicesE3 + I,indicesE3 + L,dot(- 1,ones(length(indicesE3),2)),indicesE3 + O,indicesE3 + P,indicesE3 + Q,indicesE3 + R,indicesE3 + S,dot(- 1,ones(length(indicesE3),3)))
    shearneighbours[indicesE4,:]=cat(dot(7,ones(length(indicesE4),1)),dot(- 1,ones(length(indicesE4),9)),indicesE4 + L,dot(- 1,ones(length(indicesE4),1)),indicesE4 + N,dot(- 1,ones(length(indicesE4),1)),indicesE4 + P,indicesE4 + Q,dot(- 1,ones(length(indicesE4),1)),indicesE4 + S,dot(- 1,ones(length(indicesE4),1)),indicesE4 + U,indicesE4 + V)
    shearneighbours[indicesE5,:]=cat(dot(7,ones(length(indicesE5),1)),dot(- 1,ones(length(indicesE5),4)),indicesE5 + E,dot(- 1,ones(length(indicesE5),1)),indicesE5 + G,indicesE5 + H,dot(- 1,ones(length(indicesE5),2)),dot(- 1,ones(length(indicesE5),1)),indicesE5 + N,dot(- 1,ones(length(indicesE5),4)),indicesE5 + S,dot(- 1,ones(length(indicesE5),1)),indicesE5 + U,indicesE5 + V)
    shearneighbours[indicesE6,:]=cat(dot(7,ones(length(indicesE6),1)),dot(- 1,ones(length(indicesE6),3)),indicesE6 + D,dot(- 1,ones(length(indicesE6),1)),indicesE6 + F,indicesE6 + G,dot(- 1,ones(length(indicesE6),3)),indicesE6 + M,dot(- 1,ones(length(indicesE6),4)),indicesE6 + R,dot(- 1,ones(length(indicesE6),1)),indicesE6 + T,indicesE6 + U,dot(- 1,ones(length(indicesE6),1)))
    shearneighbours[indicesE7,:]=cat(dot(7,ones(length(indicesE7),1)),indicesE7 + A,indicesE7 + B,dot(- 1,ones(length(indicesE7),1)),indicesE7 + D,dot(- 1,ones(length(indicesE7),4)),indicesE7 + I,dot(- 1,ones(length(indicesE7),1)),dot(- 1,ones(length(indicesE7),2)),indicesE7 + O,indicesE7 + P,dot(- 1,ones(length(indicesE7),1)),indicesE7 + R,dot(- 1,ones(length(indicesE7),4)))
    shearneighbours[indicesE8,:]=cat(dot(7,ones(length(indicesE8),1)),dot(- 1,ones(length(indicesE8),1)),indicesE8 + B,indicesE8 + C,dot(- 1,ones(length(indicesE8),1)),indicesE8 + E,dot(- 1,ones(length(indicesE8),4)),indicesE8 + L,dot(- 1,ones(length(indicesE8),3)),indicesE8 + P,indicesE8 + Q,dot(- 1,ones(length(indicesE8),1)),indicesE8 + S,dot(- 1,ones(length(indicesE8),3)))
    shearneighbours[indicesE9,:]=cat(dot(7,ones(length(indicesE9),1)),dot(- 1,ones(length(indicesE9),3)),indicesE9 + D,indicesE9 + E,indicesE9 + F,indicesE9 + G,indicesE9 + H,dot(- 1,ones(length(indicesE9),2)),indicesE9 + M,indicesE9 + N,dot(- 1,ones(length(indicesE9),8)))
    shearneighbours[indicesE10,:]=cat(dot(7,ones(length(indicesE10),1)),indicesE10 + A,indicesE10 + B,dot(- 1,ones(length(indicesE10),1)),indicesE10 + D,dot(- 1,ones(length(indicesE10),1)),indicesE10 + F,indicesE10 + G,dot(- 1,ones(length(indicesE10),1)),indicesE10 + I,dot(- 1,ones(length(indicesE10),1)),indicesE10 + M,dot(- 1,ones(length(indicesE10),9)))
    shearneighbours[indicesE11,:]=cat(dot(7,ones(length(indicesE11),1)),indicesE11 + A,indicesE11 + B,indicesE11 + C,indicesE11 + D,indicesE11 + E,dot(- 1,ones(length(indicesE11),3)),indicesE11 + I,indicesE11 + L,dot(- 1,ones(length(indicesE11),10)))
    shearneighbours[indicesE12,:]=cat(dot(7,ones(length(indicesE12),1)),dot(- 1,ones(length(indicesE12),1)),indicesE12 + B,indicesE12 + C,dot(- 1,ones(length(indicesE12),1)),indicesE12 + E,dot(- 1,ones(length(indicesE12),1)),indicesE12 + G,indicesE12 + H,dot(- 1,ones(length(indicesE12),1)),indicesE12 + L,dot(- 1,ones(length(indicesE12),1)),indicesE12 + N,dot(- 1,ones(length(indicesE12),8)))
    shearneighbours[indicesC1,:]=cat(dot(4,ones(length(indicesC1),1)),dot(- 1,ones(length(indicesC1),11)),indicesC1 + N,dot(- 1,ones(length(indicesC1),4)),indicesC1 + S,dot(- 1,ones(length(indicesC1),1)),indicesC1 + U,indicesC1 + V)
    shearneighbours[indicesC2,:]=cat(dot(4,ones(length(indicesC2),1)),dot(- 1,ones(length(indicesC2),10)),indicesC2 + M,dot(- 1,ones(length(indicesC2),4)),indicesC2 + R,dot(- 1,ones(length(indicesC2),1)),indicesC2 + T,indicesC2 + U,dot(- 1,ones(length(indicesC2),1)))
    shearneighbours[indicesC3,:]=cat(dot(4,ones(length(indicesC3),1)),dot(- 1,ones(length(indicesC3),8)),indicesC3 + I,dot(- 1,ones(length(indicesC3),3)),indicesC3 + O,indicesC3 + P,dot(- 1,ones(length(indicesC3),1)),indicesC3 + R,dot(- 1,ones(length(indicesC3),4)))
    shearneighbours[indicesC4,:]=cat(dot(4,ones(length(indicesC4),1)),dot(- 1,ones(length(indicesC4),9)),indicesC4 + L,dot(- 1,ones(length(indicesC4),3)),indicesC4 + P,indicesC4 + Q,dot(- 1,ones(length(indicesC4),1)),indicesC4 + S,dot(- 1,ones(length(indicesC4),3)))
    shearneighbours[indicesC5,:]=cat(dot(4,ones(length(indicesC5),1)),dot(- 1,ones(length(indicesC5),4)),indicesC5 + E,dot(- 1,ones(length(indicesC5),1)),indicesC5 + G,indicesC5 + H,dot(- 1,ones(length(indicesC5),3)),indicesC5 + N,dot(- 1,ones(length(indicesC5),8)))
    shearneighbours[indicesC6,:]=cat(dot(4,ones(length(indicesC6),1)),dot(- 1,ones(length(indicesC6),3)),indicesC6 + D,dot(- 1,ones(length(indicesC6),1)),indicesC6 + F,indicesC6 + G,dot(- 1,ones(length(indicesC6),3)),indicesC6 + M,dot(- 1,ones(length(indicesC6),9)))
    shearneighbours[indicesC7,:]=cat(dot(4,ones(length(indicesC7),1)),indicesC7 + A,indicesC7 + B,dot(- 1,ones(length(indicesC7),1)),indicesC7 + D,dot(- 1,ones(length(indicesC7),4)),indicesC7 + I,dot(- 1,ones(length(indicesC7),11)))
    shearneighbours[indicesC8,:]=cat(dot(4,ones(length(indicesC8),1)),dot(- 1,ones(length(indicesC8),1)),indicesC8 + B,indicesC8 + C,dot(- 1,ones(length(indicesC8),1)),indicesC8 + E,dot(- 1,ones(length(indicesC8),4)),indicesC8 + L,dot(- 1,ones(length(indicesC8),10)))
    if flagintbounds:
        for i in arange(1,size(indicesintbounds,1)).reshape(-1):
            index=indicesintbounds[i,1]
            if 1 == typeintbounds[i,1]:
                shearneighbours[index,:]=cat(20,index + A,index + B,index + C,index + D,index + E,index + F,index + G,index + H,index + I,index + L,index + M,index + N,index + O,index + P,index + Q,index + R,index + S,index + T,index + U,- 1)
            else:
                if 2 == typeintbounds[i,1]:
                    shearneighbours[index,:]=cat(20,index + A,index + B,index + C,index + D,index + E,index + F,index + G,index + H,index + I,index + L,index + M,index + N,index + O,index + P,index + Q,index + R,index + S,- 1,index + U,index + V)
                else:
                    if 3 == typeintbounds[i,1]:
                        shearneighbours[index,:]=cat(20,index + A,index + B,index + C,index + D,index + E,index + F,index + G,index + H,index + I,index + L,index + M,index + N,- 1,index + P,index + Q,index + R,index + S,index + T,index + U,index + V)
                    else:
                        if 4 == typeintbounds[i,1]:
                            shearneighbours[index,:]=cat(20,index + A,index + B,index + C,index + D,index + E,index + F,index + G,index + H,index + I,index + L,index + M,index + N,index + O,index + P,- 1,index + R,index + S,index + T,index + U,index + V)
                        else:
                            if 5 == typeintbounds[i,1]:
                                shearneighbours[index,:]=cat(20,index + A,index + B,index + C,index + D,index + E,index + F,index + G,- 1,index + I,index + L,index + M,index + N,index + O,index + P,index + Q,index + R,index + S,index + T,index + U,index + V)
                            else:
                                if 6 == typeintbounds[i,1]:
                                    shearneighbours[index,:]=cat(20,index + A,index + B,index + C,index + D,index + E,- 1,index + G,index + H,index + I,index + L,index + M,index + N,index + O,index + P,index + Q,index + R,index + S,index + T,index + U,index + V)
                                else:
                                    if 7 == typeintbounds[i,1]:
                                        shearneighbours[index,:]=cat(20,- 1,index + B,index + C,index + D,index + E,index + F,index + G,index + H,index + I,index + L,index + M,index + N,index + O,index + P,index + Q,index + R,index + S,index + T,index + U,index + V)
                                    else:
                                        if 8 == typeintbounds[i,1]:
                                            shearneighbours[index,:]=cat(20,index + A,index + B,- 1,index + D,index + E,index + F,index + G,index + H,index + I,index + L,index + M,index + N,index + O,index + P,index + Q,index + R,index + S,index + T,index + U,index + V)
                                        else:
                                            if 9 == typeintbounds[i,1]:
                                                shearneighbours[index,:]=cat(20,index + A,index + B,index + C,index + D,index + E,index + F,index + G,index + H,index + I,index + L,index + M,index + N,index + O,index + P,index + Q,index + R,index + S,- 1,- 1,- 1)
                                            else:
                                                if 10 == typeintbounds[i,1]:
                                                    shearneighbours[index,:]=cat(20,index + A,index + B,index + C,index + D,index + E,index + F,index + G,index + H,index + I,index + L,index + M,index + N,- 1,index + P,index + Q,- 1,index + S,- 1,index + U,index + V)
                                                else:
                                                    if 11 == typeintbounds[i,1]:
                                                        shearneighbours[index,:]=cat(20,index + A,index + B,index + C,index + D,index + E,index + F,index + G,index + H,index + I,index + L,index + M,index + N,- 1,- 1,- 1,index + R,index + S,index + T,index + U,index + V)
                                                    else:
                                                        if 12 == typeintbounds[i,1]:
                                                            shearneighbours[index,:]=cat(20,index + A,index + B,index + C,index + D,index + E,index + F,index + G,index + H,index + I,index + L,index + M,index + N,index + O,index + P,- 1,index + R,- 1,index + T,index + U,- 1)
                                                        else:
                                                            if 13 == typeintbounds[i,1]:
                                                                shearneighbours[index,:]=cat(20,index + A,index + B,index + C,index + D,index + E,index + F,index + G,- 1,index + I,index + L,index + M,- 1,index + O,index + P,index + Q,index + R,index + S,index + T,index + U,- 1)
                                                            else:
                                                                if 14 == typeintbounds[i,1]:
                                                                    shearneighbours[index,:]=cat(20,index + A,index + B,index + C,index + D,index + E,- 1,index + G,index + H,index + I,index + L,- 1,index + N,index + O,index + P,index + Q,index + R,index + S,- 1,index + U,index + V)
                                                                else:
                                                                    if 15 == typeintbounds[i,1]:
                                                                        shearneighbours[index,:]=cat(20,- 1,index + B,index + C,index + D,index + E,index + F,index + G,index + H,- 1,index + L,index + M,index + N,- 1,index + P,index + Q,index + R,index + S,index + T,index + U,index + V)
                                                                    else:
                                                                        if 16 == typeintbounds[i,1]:
                                                                            shearneighbours[index,:]=cat(20,index + A,index + B,- 1,index + D,index + E,index + F,index + G,index + H,index + I,- 1,index + M,index + N,index + O,index + P,- 1,index + R,index + S,index + T,index + U,index + V)
                                                                        else:
                                                                            if 17 == typeintbounds[i,1]:
                                                                                shearneighbours[index,:]=cat(20,index + A,index + B,index + C,index + D,index + E,- 1,- 1,- 1,index + I,index + L,index + M,index + N,index + O,index + P,index + Q,index + R,index + S,index + T,index + U,index + V)
                                                                            else:
                                                                                if 18 == typeintbounds[i,1]:
                                                                                    shearneighbours[index,:]=cat(20,- 1,index + B,index + C,- 1,index + E,- 1,index + G,index + H,index + I,index + L,index + M,index + N,index + O,index + P,index + Q,index + R,index + S,index + T,index + U,index + V)
                                                                                else:
                                                                                    if 19 == typeintbounds[i,1]:
                                                                                        shearneighbours[index,:]=cat(20,- 1,- 1,- 1,index + D,index + E,index + F,index + G,index + H,index + I,index + L,index + M,index + N,index + O,index + P,index + Q,index + R,index + S,index + T,index + U,index + V)
                                                                                    else:
                                                                                        if 20 == typeintbounds[i,1]:
                                                                                            shearneighbours[index,:]=cat(20,index + A,index + B,- 1,index + D,- 1,index + F,index + G,- 1,index + I,index + L,index + M,index + N,index + O,index + P,index + Q,index + R,index + S,index + T,index + U,index + V)
                                                                                        else:
                                                                                            if 21 == typeintbounds[i,1]:
                                                                                                shearneighbours[index,:]=cat(12,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,index + I,index + L,index + M,index + N,index + O,index + P,index + Q,index + R,index + S,index + T,index + U,index + V)
                                                                                            else:
                                                                                                if 22 == typeintbounds[i,1]:
                                                                                                    shearneighbours[index,:]=cat(12,- 1,- 1,- 1,index + D,index + E,index + F,index + G,index + H,- 1,- 1,index + M,index + N,- 1,- 1,- 1,index + R,index + S,index + T,index + U,index + V)
                                                                                                else:
                                                                                                    if 23 == typeintbounds[i,1]:
                                                                                                        shearneighbours[index,:]=cat(12,index + A,index + B,- 1,index + D,- 1,index + F,index + G,- 1,index + I,- 1,index + M,- 1,index + O,index + P,- 1,index + R,- 1,index + T,index + U,- 1)
                                                                                                    else:
                                                                                                        if 24 == typeintbounds[i,1]:
                                                                                                            shearneighbours[index,:]=cat(12,index + A,index + B,index + C,index + D,index + E,- 1,- 1,- 1,index + I,index + L,- 1,- 1,index + O,index + P,index + Q,index + R,index + S,- 1,- 1,- 1)
                                                                                                        else:
                                                                                                            if 25 == typeintbounds[i,1]:
                                                                                                                shearneighbours[index,:]=cat(12,- 1,index + B,index + C,- 1,index + E,- 1,index + G,index + H,- 1,index + L,- 1,index + N,- 1,index + P,index + Q,- 1,index + S,- 1,index + U,index + V)
                                                                                                            else:
                                                                                                                if 26 == typeintbounds[i,1]:
                                                                                                                    shearneighbours[index,:]=cat(12,index + A,index + B,index + C,index + D,index + E,index + F,index + G,index + H,index + I,index + L,index + M,index + N,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1)
                                                                                                                else:
                                                                                                                    if 27 == typeintbounds[i,1]:
                                                                                                                        shearneighbours[index,:]=cat(4,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,index + N,- 1,- 1,- 1,- 1,index + S,- 1,index + U,index + V)
                                                                                                                    else:
                                                                                                                        if 28 == typeintbounds[i,1]:
                                                                                                                            shearneighbours[index,:]=cat(4,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,index + M,- 1,- 1,- 1,- 1,index + R,- 1,index + T,index + U,- 1)
                                                                                                                        else:
                                                                                                                            if 29 == typeintbounds[i,1]:
                                                                                                                                shearneighbours[index,:]=cat(4,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,index + I,- 1,- 1,- 1,index + O,index + P,- 1,index + R,- 1,- 1,- 1,- 1)
                                                                                                                            else:
                                                                                                                                if 30 == typeintbounds[i,1]:
                                                                                                                                    shearneighbours[index,:]=cat(4,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,index + L,- 1,- 1,- 1,index + P,index + Q,- 1,index + S,- 1,- 1,- 1)
                                                                                                                                else:
                                                                                                                                    if 31 == typeintbounds[i,1]:
                                                                                                                                        shearneighbours[index,:]=cat(4,- 1,- 1,- 1,- 1,index + E,- 1,index + G,index + H,- 1,- 1,- 1,index + N,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1)
                                                                                                                                    else:
                                                                                                                                        if 32 == typeintbounds[i,1]:
                                                                                                                                            shearneighbours[index,:]=cat(4,- 1,- 1,- 1,index + D,- 1,index + F,index + G,- 1,- 1,- 1,index + M,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1)
                                                                                                                                        else:
                                                                                                                                            if 33 == typeintbounds[i,1]:
                                                                                                                                                shearneighbours[index,:]=cat(4,index + A,index + B,- 1,index + D,- 1,- 1,- 1,- 1,index + I,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1)
                                                                                                                                            else:
                                                                                                                                                if 34 == typeintbounds[i,1]:
                                                                                                                                                    shearneighbours[index,:]=cat(4,- 1,index + B,index + C,- 1,index + E,- 1,- 1,- 1,- 1,index + L,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1)
                                                                                                                                                else:
                                                                                                                                                    if 35 == typeintbounds[i,1]:
                                                                                                                                                        shearneighbours[index,:]=cat(7,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,index + M,index + N,- 1,- 1,- 1,index + R,index + S,index + T,index + U,index + V)
                                                                                                                                                    else:
                                                                                                                                                        if 36 == typeintbounds[i,1]:
                                                                                                                                                            shearneighbours[index,:]=cat(7,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,index + I,- 1,index + M,- 1,index + O,index + P,- 1,index + R,- 1,index + T,index + U,- 1)
                                                                                                                                                        else:
                                                                                                                                                            if 37 == typeintbounds[i,1]:
                                                                                                                                                                shearneighbours[index,:]=cat(7,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,index + I,index + L,- 1,- 1,index + O,index + P,index + Q,index + R,index + S,- 1,- 1,- 1)
                                                                                                                                                            else:
                                                                                                                                                                if 38 == typeintbounds[i,1]:
                                                                                                                                                                    shearneighbours[index,:]=cat(7,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,index + L,- 1,index + N,- 1,index + P,index + Q,- 1,index + S,- 1,index + U,index + V)
                                                                                                                                                                else:
                                                                                                                                                                    if 39 == typeintbounds[i,1]:
                                                                                                                                                                        shearneighbours[index,:]=cat(7,- 1,- 1,- 1,- 1,index + E,- 1,index + G,index + H,- 1,- 1,- 1,index + N,- 1,- 1,- 1,- 1,index + S,- 1,index + U,index + V)
                                                                                                                                                                    else:
                                                                                                                                                                        if 40 == typeintbounds[i,1]:
                                                                                                                                                                            shearneighbours[index,:]=cat(7,- 1,- 1,- 1,index + D,- 1,index + F,index + G,- 1,- 1,- 1,index + M,- 1,- 1,- 1,- 1,index + R,- 1,index + T,index + U,- 1)
                                                                                                                                                                        else:
                                                                                                                                                                            if 41 == typeintbounds[i,1]:
                                                                                                                                                                                shearneighbours[index,:]=cat(7,index + A,index + B,- 1,index + D,- 1,- 1,- 1,- 1,index + I,- 1,- 1,- 1,index + O,index + P,- 1,index + R,- 1,- 1,- 1,- 1)
                                                                                                                                                                            else:
                                                                                                                                                                                if 42 == typeintbounds[i,1]:
                                                                                                                                                                                    shearneighbours[index,:]=cat(7,- 1,index + B,index + C,- 1,index + E,- 1,- 1,- 1,- 1,index + L,- 1,- 1,- 1,index + P,index + Q,- 1,index + S,- 1,- 1,- 1)
                                                                                                                                                                                else:
                                                                                                                                                                                    if 43 == typeintbounds[i,1]:
                                                                                                                                                                                        shearneighbours[index,:]=cat(7,- 1,- 1,- 1,index + D,index + E,index + F,index + G,index + H,- 1,- 1,index + M,index + N,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1)
                                                                                                                                                                                    else:
                                                                                                                                                                                        if 44 == typeintbounds[i,1]:
                                                                                                                                                                                            shearneighbours[index,:]=cat(7,index + A,index + B,- 1,index + D,- 1,index + F,index + G,- 1,index + I,- 1,index + M,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1)
                                                                                                                                                                                        else:
                                                                                                                                                                                            if 45 == typeintbounds[i,1]:
                                                                                                                                                                                                shearneighbours[index,:]=cat(7,index + A,index + B,index + C,index + D,index + E,- 1,- 1,- 1,index + I,index + L,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1)
                                                                                                                                                                                            else:
                                                                                                                                                                                                if 46 == typeintbounds[i,1]:
                                                                                                                                                                                                    shearneighbours[index,:]=cat(7,- 1,index + B,index + C,- 1,index + E,- 1,index + G,index + H,- 1,index + L,- 1,index + N,- 1,- 1,- 1,- 1,- 1,- 1,- 1,- 1)
    
    # ---> bend neighbours
    
    bendneighbours[indicesinternalbulk,:]=cat(dot(6,ones(length(indicesinternalbulk),1)),indicesinternalbulk - 2,indicesinternalbulk + 2,indicesinternalbulk - dot(2,Nx),indicesinternalbulk + dot(2,Nx),indicesinternalbulk - dot(dot(2,Nx),Ny),indicesinternalbulk + dot(dot(2,Nx),Ny))
    # bendneighbours(indicesF1,:)          = [5*ones(length(indicesF1),1) indicesF1-2                  indicesF1+2                  indicesF1-2*Nx               indicesF1+2*Nx               -1*ones(length(indicesF1),1) indicesF1+2*Nx*Ny           ];
# bendneighbours(indicesF2,:)          = [5*ones(length(indicesF2),1) indicesF2-2                  indicesF2+2                  -1*ones(length(indicesF2),1) indicesF2+2*Nx               indicesF2-2*Nx*Ny            indicesF2+2*Nx*Ny           ];
# bendneighbours(indicesF3,:)          = [5*ones(length(indicesF3),1) indicesF3-2                  -1*ones(length(indicesF3),1) indicesF3-2*Nx               indicesF3+2*Nx               indicesF3-2*Nx*Ny            indicesF3+2*Nx*Ny           ];
# bendneighbours(indicesF4,:)          = [5*ones(length(indicesF4),1) indicesF4-2                  indicesF4+2                  indicesF4-2*Nx               -1*ones(length(indicesF4),1) indicesF4-2*Nx*Ny            indicesF4+2*Nx*Ny           ];
# bendneighbours(indicesF5,:)          = [5*ones(length(indicesF5),1) -1*ones(length(indicesF5),1) indicesF5+2                  indicesF5-2*Nx               indicesF5+2*Nx               indicesF5-2*Nx*Ny            indicesF5+2*Nx*Ny           ];
# bendneighbours(indicesF6,:)          = [5*ones(length(indicesF6),1) indicesF6-2                  indicesF6+2                  indicesF6-2*Nx               indicesF6+2*Nx               indicesF6-2*Nx*Ny            -1*ones(length(indicesF6),1)];
# 
# bendneighbours(indicesE1,:)          = [4*ones(length(indicesE1),1) indicesE1-2                  indicesE1+2                  -1*ones(length(indicesE1),1) indicesE1+2*Nx               -1*ones(length(indicesE1),1) indicesE1+2*Nx*Ny           ];
# bendneighbours(indicesE2,:)          = [4*ones(length(indicesE2),1) indicesE2-2                  -1*ones(length(indicesE2),1) indicesE2-2*Nx               indicesE2+2*Nx               -1*ones(length(indicesE2),1) indicesE2+2*Nx*Ny           ];
# bendneighbours(indicesE3,:)          = [4*ones(length(indicesE3),1) indicesE3-2                  indicesE3+2                  indicesE3-2*Nx               -1*ones(length(indicesE3),1) -1*ones(length(indicesE3),1) indicesE3+2*Nx*Ny           ];
# bendneighbours(indicesE4,:)          = [4*ones(length(indicesE4),1) -1*ones(length(indicesE4),1) indicesE4+2                  indicesE4-2*Nx               indicesE4+2*Nx               -1*ones(length(indicesE4),1) indicesE4+2*Nx*Ny           ];
# bendneighbours(indicesE5,:)          = [4*ones(length(indicesE5),1) -1*ones(length(indicesE5),1) indicesE5+2                  -1*ones(length(indicesE5),1) indicesE5+2*Nx               indicesE5-2*Nx*Ny            indicesE5+2*Nx*Ny           ];
# bendneighbours(indicesE6,:)          = [4*ones(length(indicesE6),1) indicesE6-2                  -1*ones(length(indicesE6),1) -1*ones(length(indicesE6),1) indicesE6+2*Nx               indicesE6-2*Nx*Ny            indicesE6+2*Nx*Ny           ];
# bendneighbours(indicesE7,:)          = [4*ones(length(indicesE7),1) indicesE7-2                  -1*ones(length(indicesE7),1) indicesE7-2*Nx               -1*ones(length(indicesE7),1) indicesE7-2*Nx*Ny            indicesE7+2*Nx*Ny           ];
# bendneighbours(indicesE8,:)          = [4*ones(length(indicesE8),1) -1*ones(length(indicesE8),1) indicesE8+2                  indicesE8-2*Nx               -1*ones(length(indicesE8),1) indicesE8-2*Nx*Ny            indicesE8+2*Nx*Ny           ];
# bendneighbours(indicesE9,:)          = [4*ones(length(indicesE9),1) indicesE9-2                  indicesE9+2                  -1*ones(length(indicesE9),1) indicesE9+2*Nx               indicesE9-2*Nx*Ny            -1*ones(length(indicesE9),1)];
# bendneighbours(indicesE10,:)         = [4*ones(length(indicesE10),1) indicesE10-2                 -1*ones(length(indicesE10),1) indicesE10-2*Nx              indicesE10+2*Nx              indicesE10-2*Nx*Ny           -1*ones(length(indicesE10),1)];
# bendneighbours(indicesE11,:)         = [4*ones(length(indicesE11),1) indicesE11-2                 indicesE11+2                 indicesE11-2*Nx              -1*ones(length(indicesE11),1) indicesE11-2*Nx*Ny           -1*ones(length(indicesE11),1)];
# bendneighbours(indicesE12,:)         = [4*ones(length(indicesE12),1) -1*ones(length(indicesE12),1) indicesE12+2                 indicesE12-2*Nx              indicesE12+2*Nx              indicesE12-2*Nx*Ny           -1*ones(length(indicesE12),1)];
    
    bendneighbours[indicesC1,:]=cat(dot(3,ones(length(indicesC1),1)),dot(- 1,ones(length(indicesC1),1)),indicesC1 + 2,dot(- 1,ones(length(indicesC1),1)),indicesC1 + dot(2,Nx),dot(- 1,ones(length(indicesC1),1)),indicesC1 + dot(dot(2,Nx),Ny))
    bendneighbours[indicesC2,:]=cat(dot(3,ones(length(indicesC2),1)),indicesC2 - 2,dot(- 1,ones(length(indicesC2),1)),dot(- 1,ones(length(indicesC2),1)),indicesC2 + dot(2,Nx),dot(- 1,ones(length(indicesC2),1)),indicesC2 + dot(dot(2,Nx),Ny))
    bendneighbours[indicesC3,:]=cat(dot(3,ones(length(indicesC3),1)),indicesC3 - 2,dot(- 1,ones(length(indicesC3),1)),indicesC3 - dot(2,Nx),dot(- 1,ones(length(indicesC3),1)),dot(- 1,ones(length(indicesC3),1)),indicesC3 + dot(dot(2,Nx),Ny))
    bendneighbours[indicesC4,:]=cat(dot(3,ones(length(indicesC4),1)),dot(- 1,ones(length(indicesC4),1)),indicesC4 + 2,indicesC4 - dot(2,Nx),dot(- 1,ones(length(indicesC4),1)),dot(- 1,ones(length(indicesC4),1)),indicesC4 + dot(dot(2,Nx),Ny))
    bendneighbours[indicesC5,:]=cat(dot(3,ones(length(indicesC5),1)),dot(- 1,ones(length(indicesC5),1)),indicesC5 + 2,dot(- 1,ones(length(indicesC5),1)),indicesC5 + dot(2,Nx),indicesC5 - dot(dot(2,Nx),Ny),dot(- 1,ones(length(indicesC5),1)))
    bendneighbours[indicesC6,:]=cat(dot(3,ones(length(indicesC6),1)),indicesC6 - 2,dot(- 1,ones(length(indicesC6),1)),dot(- 1,ones(length(indicesC6),1)),indicesC6 + dot(2,Nx),indicesC6 - dot(dot(2,Nx),Ny),dot(- 1,ones(length(indicesC6),1)))
    bendneighbours[indicesC7,:]=cat(dot(3,ones(length(indicesC7),1)),indicesC7 - 2,dot(- 1,ones(length(indicesC7),1)),indicesC7 - dot(2,Nx),dot(- 1,ones(length(indicesC7),1)),indicesC7 - dot(dot(2,Nx),Ny),dot(- 1,ones(length(indicesC7),1)))
    bendneighbours[indicesC8,:]=cat(dot(3,ones(length(indicesC8),1)),dot(- 1,ones(length(indicesC8),1)),indicesC8 + 2,indicesC8 - dot(2,Nx),dot(- 1,ones(length(indicesC8),1)),indicesC8 - dot(dot(2,Nx),Ny),dot(- 1,ones(length(indicesC8),1)))
    bendneighbours[indicesinternalF1,:]=cat(dot(5,ones(length(indicesinternalF1),1)),indicesinternalF1 - 2,indicesinternalF1 + 2,indicesinternalF1 - dot(2,Nx),indicesinternalF1 + dot(2,Nx),dot(- 1,ones(length(indicesinternalF1),1)),indicesinternalF1 + dot(dot(2,Nx),Ny))
    bendneighbours[indicesinternalF2,:]=cat(dot(5,ones(length(indicesinternalF2),1)),indicesinternalF2 - 2,indicesinternalF2 + 2,dot(- 1,ones(length(indicesinternalF2),1)),indicesinternalF2 + dot(2,Nx),indicesinternalF2 - dot(dot(2,Nx),Ny),indicesinternalF2 + dot(dot(2,Nx),Ny))
    bendneighbours[indicesinternalF3,:]=cat(dot(5,ones(length(indicesinternalF3),1)),indicesinternalF3 - 2,dot(- 1,ones(length(indicesinternalF3),1)),indicesinternalF3 - dot(2,Nx),indicesinternalF3 + dot(2,Nx),indicesinternalF3 - dot(dot(2,Nx),Ny),indicesinternalF3 + dot(dot(2,Nx),Ny))
    bendneighbours[indicesinternalF4,:]=cat(dot(5,ones(length(indicesinternalF4),1)),indicesinternalF4 - 2,indicesinternalF4 + 2,indicesinternalF4 - dot(2,Nx),dot(- 1,ones(length(indicesinternalF4),1)),indicesinternalF4 - dot(dot(2,Nx),Ny),indicesinternalF4 + dot(dot(2,Nx),Ny))
    bendneighbours[indicesinternalF5,:]=cat(dot(5,ones(length(indicesinternalF5),1)),dot(- 1,ones(length(indicesinternalF5),1)),indicesinternalF5 + 2,indicesinternalF5 - dot(2,Nx),indicesinternalF5 + dot(2,Nx),indicesinternalF5 - dot(dot(2,Nx),Ny),indicesinternalF5 + dot(dot(2,Nx),Ny))
    bendneighbours[indicesinternalF6,:]=cat(dot(5,ones(length(indicesinternalF6),1)),indicesinternalF6 - 2,indicesinternalF6 + 2,indicesinternalF6 - dot(2,Nx),indicesinternalF6 + dot(2,Nx),indicesinternalF6 - dot(dot(2,Nx),Ny),dot(- 1,ones(length(indicesinternalF6),1)))
    bendneighbours[indicesinternalE1,:]=cat(dot(4,ones(length(indicesinternalE1),1)),indicesinternalE1 - 2,indicesinternalE1 + 2,dot(- 1,ones(length(indicesinternalE1),1)),indicesinternalE1 + dot(2,Nx),dot(- 1,ones(length(indicesinternalE1),1)),indicesinternalE1 + dot(dot(2,Nx),Ny))
    bendneighbours[indicesinternalE2,:]=cat(dot(4,ones(length(indicesinternalE2),1)),indicesinternalE2 - 2,dot(- 1,ones(length(indicesinternalE2),1)),indicesinternalE2 - dot(2,Nx),indicesinternalE2 + dot(2,Nx),dot(- 1,ones(length(indicesinternalE2),1)),indicesinternalE2 + dot(dot(2,Nx),Ny))
    bendneighbours[indicesinternalE3,:]=cat(dot(4,ones(length(indicesinternalE3),1)),indicesinternalE3 - 2,indicesinternalE3 + 2,indicesinternalE3 - dot(2,Nx),dot(- 1,ones(length(indicesinternalE3),1)),dot(- 1,ones(length(indicesinternalE3),1)),indicesinternalE3 + dot(dot(2,Nx),Ny))
    bendneighbours[indicesinternalE4,:]=cat(dot(4,ones(length(indicesinternalE4),1)),dot(- 1,ones(length(indicesinternalE4),1)),indicesinternalE4 + 2,indicesinternalE4 - dot(2,Nx),indicesinternalE4 + dot(2,Nx),dot(- 1,ones(length(indicesinternalE4),1)),indicesinternalE4 + dot(dot(2,Nx),Ny))
    bendneighbours[indicesinternalE5,:]=cat(dot(4,ones(length(indicesinternalE5),1)),dot(- 1,ones(length(indicesinternalE5),1)),indicesinternalE5 + 2,dot(- 1,ones(length(indicesinternalE5),1)),indicesinternalE5 + dot(2,Nx),indicesinternalE5 - dot(dot(2,Nx),Ny),indicesinternalE5 + dot(dot(2,Nx),Ny))
    bendneighbours[indicesinternalE6,:]=cat(dot(4,ones(length(indicesinternalE6),1)),indicesinternalE6 - 2,dot(- 1,ones(length(indicesinternalE6),1)),dot(- 1,ones(length(indicesinternalE6),1)),indicesinternalE6 + dot(2,Nx),indicesinternalE6 - dot(dot(2,Nx),Ny),indicesinternalE6 + dot(dot(2,Nx),Ny))
    bendneighbours[indicesinternalE7,:]=cat(dot(4,ones(length(indicesinternalE7),1)),indicesinternalE7 - 2,dot(- 1,ones(length(indicesinternalE7),1)),indicesinternalE7 - dot(2,Nx),dot(- 1,ones(length(indicesinternalE7),1)),indicesinternalE7 - dot(dot(2,Nx),Ny),indicesinternalE7 + dot(dot(2,Nx),Ny))
    bendneighbours[indicesinternalE8,:]=cat(dot(4,ones(length(indicesinternalE8),1)),dot(- 1,ones(length(indicesinternalE8),1)),indicesinternalE8 + 2,indicesinternalE8 - dot(2,Nx),dot(- 1,ones(length(indicesinternalE8),1)),indicesinternalE8 - dot(dot(2,Nx),Ny),indicesinternalE8 + dot(dot(2,Nx),Ny))
    bendneighbours[indicesinternalE9,:]=cat(dot(4,ones(length(indicesinternalE9),1)),indicesinternalE9 - 2,indicesinternalE9 + 2,dot(- 1,ones(length(indicesinternalE9),1)),indicesinternalE9 + dot(2,Nx),indicesinternalE9 - dot(dot(2,Nx),Ny),dot(- 1,ones(length(indicesinternalE9),1)))
    bendneighbours[indicesinternalE10,:]=cat(dot(4,ones(length(indicesinternalE10),1)),indicesinternalE10 - 2,dot(- 1,ones(length(indicesinternalE10),1)),indicesinternalE10 - dot(2,Nx),indicesinternalE10 + dot(2,Nx),indicesinternalE10 - dot(dot(2,Nx),Ny),dot(- 1,ones(length(indicesinternalE10),1)))
    bendneighbours[indicesinternalE11,:]=cat(dot(4,ones(length(indicesinternalE11),1)),indicesinternalE11 - 2,indicesinternalE11 + 2,indicesinternalE11 - dot(2,Nx),dot(- 1,ones(length(indicesinternalE11),1)),indicesinternalE11 - dot(dot(2,Nx),Ny),dot(- 1,ones(length(indicesinternalE11),1)))
    bendneighbours[indicesinternalE12,:]=cat(dot(4,ones(length(indicesinternalE12),1)),dot(- 1,ones(length(indicesinternalE12),1)),indicesinternalE12 + 2,indicesinternalE12 - dot(2,Nx),indicesinternalE12 + dot(2,Nx),indicesinternalE12 - dot(dot(2,Nx),Ny),dot(- 1,ones(length(indicesinternalE12),1)))
    bendneighbours[indicesinternalC1,:]=cat(dot(3,ones(length(indicesinternalC1),1)),dot(- 1,ones(length(indicesinternalC1),1)),indicesinternalC1 + 2,dot(- 1,ones(length(indicesinternalC1),1)),indicesinternalC1 + dot(2,Nx),dot(- 1,ones(length(indicesinternalC1),1)),indicesinternalC1 + dot(dot(2,Nx),Ny))
    bendneighbours[indicesinternalC2,:]=cat(dot(3,ones(length(indicesinternalC2),1)),indicesinternalC2 - 2,dot(- 1,ones(length(indicesinternalC2),1)),dot(- 1,ones(length(indicesinternalC2),1)),indicesinternalC2 + dot(2,Nx),dot(- 1,ones(length(indicesinternalC2),1)),indicesinternalC2 + dot(dot(2,Nx),Ny))
    bendneighbours[indicesinternalC3,:]=cat(dot(3,ones(length(indicesinternalC3),1)),indicesinternalC3 - 2,dot(- 1,ones(length(indicesinternalC3),1)),indicesinternalC3 - dot(2,Nx),dot(- 1,ones(length(indicesinternalC3),1)),dot(- 1,ones(length(indicesinternalC3),1)),indicesinternalC3 + dot(dot(2,Nx),Ny))
    bendneighbours[indicesinternalC4,:]=cat(dot(3,ones(length(indicesinternalC4),1)),dot(- 1,ones(length(indicesinternalC4),1)),indicesinternalC4 + 2,indicesinternalC4 - dot(2,Nx),dot(- 1,ones(length(indicesinternalC4),1)),dot(- 1,ones(length(indicesinternalC4),1)),indicesinternalC4 + dot(dot(2,Nx),Ny))
    bendneighbours[indicesinternalC5,:]=cat(dot(3,ones(length(indicesinternalC5),1)),dot(- 1,ones(length(indicesinternalC5),1)),indicesinternalC5 + 2,dot(- 1,ones(length(indicesinternalC5),1)),indicesinternalC5 + dot(2,Nx),indicesinternalC5 - dot(dot(2,Nx),Ny),dot(- 1,ones(length(indicesinternalC5),1)))
    bendneighbours[indicesinternalC6,:]=cat(dot(3,ones(length(indicesinternalC6),1)),indicesinternalC6 - 2,dot(- 1,ones(length(indicesinternalC6),1)),dot(- 1,ones(length(indicesinternalC6),1)),indicesinternalC6 + dot(2,Nx),indicesinternalC6 - dot(dot(2,Nx),Ny),dot(- 1,ones(length(indicesinternalC6),1)))
    bendneighbours[indicesinternalC7,:]=cat(dot(3,ones(length(indicesinternalC7),1)),indicesinternalC7 - 2,dot(- 1,ones(length(indicesinternalC7),1)),indicesinternalC7 - dot(2,Nx),dot(- 1,ones(length(indicesinternalC7),1)),indicesinternalC7 - dot(dot(2,Nx),Ny),dot(- 1,ones(length(indicesinternalC7),1)))
    bendneighbours[indicesinternalC8,:]=cat(dot(3,ones(length(indicesinternalC8),1)),dot(- 1,ones(length(indicesinternalC8),1)),indicesinternalC8 + 2,indicesinternalC8 - dot(2,Nx),dot(- 1,ones(length(indicesinternalC8),1)),indicesinternalC8 - dot(dot(2,Nx),Ny),dot(- 1,ones(length(indicesinternalC8),1)))
    if flagintbounds:
        for i in arange(1,size(indicesintbounds,1)).reshape(-1):
            index=indicesintbounds[i,1]
            if 1 == typeintbounds[i,1]:
                bendneighbours[index,:]=cat(6,index - 2,index + 2,index - dot(2,Nx),index + dot(2,Nx),index - dot(dot(2,Nx),Ny),index + dot(dot(2,Nx),Ny))
            else:
                if 2 == typeintbounds[i,1]:
                    bendneighbours[index,:]=cat(6,index - 2,index + 2,index - dot(2,Nx),index + dot(2,Nx),index - dot(dot(2,Nx),Ny),index + dot(dot(2,Nx),Ny))
                else:
                    if 3 == typeintbounds[i,1]:
                        bendneighbours[index,:]=cat(6,index - 2,index + 2,index - dot(2,Nx),index + dot(2,Nx),index - dot(dot(2,Nx),Ny),index + dot(dot(2,Nx),Ny))
                    else:
                        if 4 == typeintbounds[i,1]:
                            bendneighbours[index,:]=cat(6,index - 2,index + 2,index - dot(2,Nx),index + dot(2,Nx),index - dot(dot(2,Nx),Ny),index + dot(dot(2,Nx),Ny))
                        else:
                            if 5 == typeintbounds[i,1]:
                                bendneighbours[index,:]=cat(6,index - 2,index + 2,index - dot(2,Nx),index + dot(2,Nx),index - dot(dot(2,Nx),Ny),index + dot(dot(2,Nx),Ny))
                            else:
                                if 6 == typeintbounds[i,1]:
                                    bendneighbours[index,:]=cat(6,index - 2,index + 2,index - dot(2,Nx),index + dot(2,Nx),index - dot(dot(2,Nx),Ny),index + dot(dot(2,Nx),Ny))
                                else:
                                    if 7 == typeintbounds[i,1]:
                                        bendneighbours[index,:]=cat(6,index - 2,index + 2,index - dot(2,Nx),index + dot(2,Nx),index - dot(dot(2,Nx),Ny),index + dot(dot(2,Nx),Ny))
                                    else:
                                        if 8 == typeintbounds[i,1]:
                                            bendneighbours[index,:]=cat(6,index - 2,index + 2,index - dot(2,Nx),index + dot(2,Nx),index - dot(dot(2,Nx),Ny),index + dot(dot(2,Nx),Ny))
                                        else:
                                            if 9 == typeintbounds[i,1]:
                                                bendneighbours[index,:]=cat(6,index - 2,index + 2,index - dot(2,Nx),index + dot(2,Nx),index - dot(dot(2,Nx),Ny),index + dot(dot(2,Nx),Ny))
                                            else:
                                                if 10 == typeintbounds[i,1]:
                                                    bendneighbours[index,:]=cat(6,index - 2,index + 2,index - dot(2,Nx),index + dot(2,Nx),index - dot(dot(2,Nx),Ny),index + dot(dot(2,Nx),Ny))
                                                else:
                                                    if 11 == typeintbounds[i,1]:
                                                        bendneighbours[index,:]=cat(6,index - 2,index + 2,index - dot(2,Nx),index + dot(2,Nx),index - dot(dot(2,Nx),Ny),index + dot(dot(2,Nx),Ny))
                                                    else:
                                                        if 12 == typeintbounds[i,1]:
                                                            bendneighbours[index,:]=cat(6,index - 2,index + 2,index - dot(2,Nx),index + dot(2,Nx),index - dot(dot(2,Nx),Ny),index + dot(dot(2,Nx),Ny))
                                                        else:
                                                            if 13 == typeintbounds[i,1]:
                                                                bendneighbours[index,:]=cat(6,index - 2,index + 2,index - dot(2,Nx),index + dot(2,Nx),index - dot(dot(2,Nx),Ny),index + dot(dot(2,Nx),Ny))
                                                            else:
                                                                if 14 == typeintbounds[i,1]:
                                                                    bendneighbours[index,:]=cat(6,index - 2,index + 2,index - dot(2,Nx),index + dot(2,Nx),index - dot(dot(2,Nx),Ny),index + dot(dot(2,Nx),Ny))
                                                                else:
                                                                    if 15 == typeintbounds[i,1]:
                                                                        bendneighbours[index,:]=cat(6,index - 2,index + 2,index - dot(2,Nx),index + dot(2,Nx),index - dot(dot(2,Nx),Ny),index + dot(dot(2,Nx),Ny))
                                                                    else:
                                                                        if 16 == typeintbounds[i,1]:
                                                                            bendneighbours[index,:]=cat(6,index - 2,index + 2,index - dot(2,Nx),index + dot(2,Nx),index - dot(dot(2,Nx),Ny),index + dot(dot(2,Nx),Ny))
                                                                        else:
                                                                            if 17 == typeintbounds[i,1]:
                                                                                bendneighbours[index,:]=cat(6,index - 2,index + 2,index - dot(2,Nx),index + dot(2,Nx),index - dot(dot(2,Nx),Ny),index + dot(dot(2,Nx),Ny))
                                                                            else:
                                                                                if 18 == typeintbounds[i,1]:
                                                                                    bendneighbours[index,:]=cat(6,index - 2,index + 2,index - dot(2,Nx),index + dot(2,Nx),index - dot(dot(2,Nx),Ny),index + dot(dot(2,Nx),Ny))
                                                                                else:
                                                                                    if 19 == typeintbounds[i,1]:
                                                                                        bendneighbours[index,:]=cat(6,index - 2,index + 2,index - dot(2,Nx),index + dot(2,Nx),index - dot(dot(2,Nx),Ny),index + dot(dot(2,Nx),Ny))
                                                                                    else:
                                                                                        if 20 == typeintbounds[i,1]:
                                                                                            bendneighbours[index,:]=cat(6,index - 2,index + 2,index - dot(2,Nx),index + dot(2,Nx),index - dot(dot(2,Nx),Ny),index + dot(dot(2,Nx),Ny))
                                                                                        else:
                                                                                            if 21 == typeintbounds[i,1]:
                                                                                                bendneighbours[index,:]=cat(5,index - 2,index + 2,index - dot(2,Nx),index + dot(2,Nx),- 1,index + dot(dot(2,Nx),Ny))
                                                                                                index2=index + dot(Nx,Ny)
                                                                                                bendneighbours[index2,:]=cat(5,index2 - 2,index2 + 2,index2 - dot(2,Nx),index2 + dot(2,Nx),- 1,index2 + dot(dot(2,Nx),Ny))
                                                                                            else:
                                                                                                if 22 == typeintbounds[i,1]:
                                                                                                    bendneighbours[index,:]=cat(5,index - 2,index + 2,- 1,index + dot(2,Nx),index - dot(dot(2,Nx),Ny),index + dot(dot(2,Nx),Ny))
                                                                                                    index2=index + Nx
                                                                                                    bendneighbours[index2,:]=cat(5,index2 - 2,index2 + 2,- 1,index2 + dot(2,Nx),index2 - dot(dot(2,Nx),Ny),index2 + dot(dot(2,Nx),Ny))
                                                                                                else:
                                                                                                    if 23 == typeintbounds[i,1]:
                                                                                                        bendneighbours[index,:]=cat(5,index - 2,- 1,index - dot(2,Nx),index + dot(2,Nx),index - dot(dot(2,Nx),Ny),index + dot(dot(2,Nx),Ny))
                                                                                                        index2=index - 1
                                                                                                        bendneighbours[index2,:]=cat(5,index2 - 2,- 1,index2 - dot(2,Nx),index2 + dot(2,Nx),index2 - dot(dot(2,Nx),Ny),index2 + dot(dot(2,Nx),Ny))
                                                                                                    else:
                                                                                                        if 24 == typeintbounds[i,1]:
                                                                                                            bendneighbours[index,:]=cat(5,index - 2,index + 2,index - dot(2,Nx),- 1,index - dot(dot(2,Nx),Ny),index + dot(dot(2,Nx),Ny))
                                                                                                            index2=index - Nx
                                                                                                            bendneighbours[index2,:]=cat(5,index2 - 2,index2 + 2,index2 - dot(2,Nx),- 1,index2 - dot(dot(2,Nx),Ny),index2 + dot(dot(2,Nx),Ny))
                                                                                                        else:
                                                                                                            if 25 == typeintbounds[i,1]:
                                                                                                                bendneighbours[index,:]=cat(5,- 1,index + 2,index - dot(2,Nx),index + dot(2,Nx),index - dot(dot(2,Nx),Ny),index + dot(dot(2,Nx),Ny))
                                                                                                                index2=index + 1
                                                                                                                bendneighbours[index2,:]=cat(5,- 1,index2 + 2,index2 - dot(2,Nx),index2 + dot(2,Nx),index2 - dot(dot(2,Nx),Ny),index2 + dot(dot(2,Nx),Ny))
                                                                                                            else:
                                                                                                                if 26 == typeintbounds[i,1]:
                                                                                                                    bendneighbours[index,:]=cat(5,index - 2,index + 2,index - dot(2,Nx),index + dot(2,Nx),index - dot(dot(2,Nx),Ny),- 1)
                                                                                                                    index2=index - dot(Nx,Ny)
                                                                                                                    bendneighbours[index2,:]=cat(5,index2 - 2,index2 + 2,index2 - dot(2,Nx),index2 + dot(2,Nx),index2 - dot(dot(2,Nx),Ny),- 1)
                                                                                                                else:
                                                                                                                    if 27 == typeintbounds[i,1]:
                                                                                                                        B=- Nx - dot(Nx,Ny)
                                                                                                                        D=- 1 - dot(Nx,Ny)
                                                                                                                        E=dot(- Nx,Ny)
                                                                                                                        L=- 1 - Nx
                                                                                                                        M=- Nx
                                                                                                                        O=- 1
                                                                                                                        l=copy(index)
                                                                                                                        indices=matlabarray(cat([l],[l + B],[l + D],[l + E],[l + L],[l + M],[l + O]))
                                                                                                                        bendneighbours[indices,:]=cat(dot(3,ones(length(indices),1)),dot(- 1,ones(length(indices),1)),indices + 2,dot(- 1,ones(length(indices),1)),indices + dot(2,Nx),dot(- 1,ones(length(indices),1)),indices + dot(dot(2,Nx),Ny))
                                                                                                                    else:
                                                                                                                        if 28 == typeintbounds[i,1]:
                                                                                                                            B=- Nx - dot(Nx,Ny)
                                                                                                                            E=dot(- Nx,Ny)
                                                                                                                            F=+ 1 - dot(Nx,Ny)
                                                                                                                            M=- Nx
                                                                                                                            N=+ 1 - Nx
                                                                                                                            P=+ 1
                                                                                                                            l=copy(index)
                                                                                                                            indices=matlabarray(cat([l],[l + B],[l + E],[l + F],[l + M],[l + N],[l + P]))
                                                                                                                            bendneighbours[indices,:]=cat(dot(3,ones(length(indices),1)),indices - 2,dot(- 1,ones(length(indices),1)),dot(- 1,ones(length(indices),1)),indices + dot(2,Nx),dot(- 1,ones(length(indices),1)),indices + dot(dot(2,Nx),Ny))
                                                                                                                        else:
                                                                                                                            if 29 == typeintbounds[i,1]:
                                                                                                                                E=dot(- Nx,Ny)
                                                                                                                                F=+ 1 - dot(Nx,Ny)
                                                                                                                                H=+ Nx - dot(Nx,Ny)
                                                                                                                                P=+ 1
                                                                                                                                R=+ Nx
                                                                                                                                S=+ 1 + Nx
                                                                                                                                l=copy(index)
                                                                                                                                indices=matlabarray(cat([l],[l + E],[l + F],[l + H],[l + P],[l + R],[l + S]))
                                                                                                                                bendneighbours[indices,:]=cat(dot(3,ones(length(indices),1)),indices - 2,dot(- 1,ones(length(indices),1)),indices - dot(2,Nx),dot(- 1,ones(length(indices),1)),dot(- 1,ones(length(indices),1)),indices + dot(dot(2,Nx),Ny))
                                                                                                                            else:
                                                                                                                                if 30 == typeintbounds[i,1]:
                                                                                                                                    D=- 1 - dot(Nx,Ny)
                                                                                                                                    E=dot(- Nx,Ny)
                                                                                                                                    H=+ Nx - dot(Nx,Ny)
                                                                                                                                    O=- 1
                                                                                                                                    Q=- 1 + Nx
                                                                                                                                    R=+ Nx
                                                                                                                                    l=copy(index)
                                                                                                                                    indices=matlabarray(cat([l],[l + D],[l + E],[l + H],[l + O],[l + Q],[l + R]))
                                                                                                                                    bendneighbours[indices,:]=cat(dot(3,ones(length(indices),1)),dot(- 1,ones(length(indices),1)),indices + 2,indices - dot(2,Nx),dot(- 1,ones(length(indices),1)),dot(- 1,ones(length(indices),1)),indices + dot(dot(2,Nx),Ny))
                                                                                                                                else:
                                                                                                                                    if 31 == typeintbounds[i,1]:
                                                                                                                                        L=- 1 - Nx
                                                                                                                                        M=- Nx
                                                                                                                                        O=- 1
                                                                                                                                        U=- Nx + dot(Nx,Ny)
                                                                                                                                        Z=- 1 + dot(Nx,Ny)
                                                                                                                                        K=dot(+ Nx,Ny)
                                                                                                                                        l=copy(index)
                                                                                                                                        indices=matlabarray(cat([l],[l + L],[l + M],[l + O],[l + U],[l + K],[l + Z]))
                                                                                                                                        bendneighbours[indices,:]=cat(dot(3,ones(length(indices),1)),dot(- 1,ones(length(indices),1)),indices + 2,dot(- 1,ones(length(indices),1)),indices + dot(2,Nx),indices - dot(dot(2,Nx),Ny),dot(- 1,ones(length(indices),1)))
                                                                                                                                    else:
                                                                                                                                        if 32 == typeintbounds[i,1]:
                                                                                                                                            M=- Nx
                                                                                                                                            N=+ 1 - Nx
                                                                                                                                            P=+ 1
                                                                                                                                            U=- Nx + dot(Nx,Ny)
                                                                                                                                            K=dot(+ Nx,Ny)
                                                                                                                                            J=+ 1 + dot(Nx,Ny)
                                                                                                                                            l=copy(index)
                                                                                                                                            indices=matlabarray(cat([l],[l + M],[l + N],[l + P],[l + U],[l + K],[l + J]))
                                                                                                                                            bendneighbours[indices,:]=cat(dot(3,ones(length(indices),1)),indices - 2,dot(- 1,ones(length(indices),1)),dot(- 1,ones(length(indices),1)),indices + dot(2,Nx),indices - dot(dot(2,Nx),Ny),dot(- 1,ones(length(indices),1)))
                                                                                                                                        else:
                                                                                                                                            if 33 == typeintbounds[i,1]:
                                                                                                                                                P=+ 1
                                                                                                                                                R=+ Nx
                                                                                                                                                S=+ 1 + Nx
                                                                                                                                                K=dot(+ Nx,Ny)
                                                                                                                                                J=+ 1 + dot(Nx,Ny)
                                                                                                                                                X=+ Nx + dot(Nx,Ny)
                                                                                                                                                l=copy(index)
                                                                                                                                                indices=matlabarray(cat([l],[l + P],[l + R],[l + S],[l + K],[l + J],[l + X]))
                                                                                                                                                bendneighbours[indices,:]=cat(dot(3,ones(length(indices),1)),indices - 2,dot(- 1,ones(length(indices),1)),indices - dot(2,Nx),dot(- 1,ones(length(indices),1)),indices - dot(dot(2,Nx),Ny),dot(- 1,ones(length(indices),1)))
                                                                                                                                            else:
                                                                                                                                                if 34 == typeintbounds[i,1]:
                                                                                                                                                    O=- 1
                                                                                                                                                    Q=- 1 + Nx
                                                                                                                                                    R=+ Nx
                                                                                                                                                    Z=- 1 + dot(Nx,Ny)
                                                                                                                                                    K=dot(+ Nx,Ny)
                                                                                                                                                    X=+ Nx + dot(Nx,Ny)
                                                                                                                                                    l=copy(index)
                                                                                                                                                    indices=matlabarray(cat([l],[l + O],[l + Q],[l + R],[l + Z],[l + K],[l + X]))
                                                                                                                                                    bendneighbours[indices,:]=cat(dot(3,ones(length(indices),1)),dot(- 1,ones(length(indices),1)),indices + 2,indices - dot(2,Nx),dot(- 1,ones(length(indices),1)),indices - dot(dot(2,Nx),Ny),dot(- 1,ones(length(indices),1)))
                                                                                                                                                else:
                                                                                                                                                    if 35 == typeintbounds[i,1]:
                                                                                                                                                        l=copy(index)
                                                                                                                                                        indices=matlabarray(cat([l],[l - dot(Nx,Ny)],[l - Nx - dot(Nx,Ny)],[l - Nx]))
                                                                                                                                                        bendneighbours[indices,:]=cat(dot(4,ones(length(indices),1)),indices - 2,indices + 2,dot(- 1,ones(length(indices),1)),indices + dot(2,Nx),dot(- 1,ones(length(indices),1)),indices + dot(dot(2,Nx),Ny))
                                                                                                                                                    else:
                                                                                                                                                        if 36 == typeintbounds[i,1]:
                                                                                                                                                            l=copy(index)
                                                                                                                                                            indices=matlabarray(cat([l],[l - dot(Nx,Ny)],[l + 1 - dot(Nx,Ny)],[l + 1]))
                                                                                                                                                            bendneighbours[indices,:]=cat(dot(4,ones(length(indices),1)),indices - 2,dot(- 1,ones(length(indices),1)),indices - dot(2,Nx),indices + dot(2,Nx),dot(- 1,ones(length(indices),1)),indices + dot(dot(2,Nx),Ny))
                                                                                                                                                        else:
                                                                                                                                                            if 37 == typeintbounds[i,1]:
                                                                                                                                                                l=copy(index)
                                                                                                                                                                indices=matlabarray(cat([l],[l - dot(Nx,Ny)],[l - dot(Nx,Ny) + Nx],[l + Nx]))
                                                                                                                                                                bendneighbours[indices,:]=cat(dot(4,ones(length(indices),1)),indices - 2,indices + 2,indices - dot(2,Nx),dot(- 1,ones(length(indices),1)),dot(- 1,ones(length(indices),1)),indices + dot(dot(2,Nx),Ny))
                                                                                                                                                            else:
                                                                                                                                                                if 38 == typeintbounds[i,1]:
                                                                                                                                                                    l=copy(index)
                                                                                                                                                                    indices=matlabarray(cat([l],[l - dot(Nx,Ny)],[l - dot(Nx,Ny) - 1],[l - 1]))
                                                                                                                                                                    bendneighbours[indices,:]=cat(dot(4,ones(length(indices),1)),dot(- 1,ones(length(indices),1)),indices + 2,indices - dot(2,Nx),indices + dot(2,Nx),dot(- 1,ones(length(indices),1)),indices + dot(dot(2,Nx),Ny))
                                                                                                                                                                else:
                                                                                                                                                                    if 39 == typeintbounds[i,1]:
                                                                                                                                                                        l=copy(index)
                                                                                                                                                                        indices=matlabarray(cat([l],[l - 1],[l - Nx],[l - 1 - Nx]))
                                                                                                                                                                        bendneighbours[indices,:]=cat(dot(4,ones(length(indices),1)),dot(- 1,ones(length(indices),1)),indices + 2,dot(- 1,ones(length(indices),1)),indices + dot(2,Nx),indices - dot(dot(2,Nx),Ny),indices + dot(dot(2,Nx),Ny))
                                                                                                                                                                    else:
                                                                                                                                                                        if 40 == typeintbounds[i,1]:
                                                                                                                                                                            l=copy(index)
                                                                                                                                                                            indices=matlabarray(cat([l],[l + 1],[l - Nx],[l + 1 - Nx]))
                                                                                                                                                                            bendneighbours[indices,:]=cat(dot(4,ones(length(indices),1)),indices - 2,dot(- 1,ones(length(indices),1)),dot(- 1,ones(length(indices),1)),indices + dot(2,Nx),indices - dot(dot(2,Nx),Ny),indices + dot(dot(2,Nx),Ny))
                                                                                                                                                                        else:
                                                                                                                                                                            if 41 == typeintbounds[i,1]:
                                                                                                                                                                                l=copy(index)
                                                                                                                                                                                indices=matlabarray(cat([l],[l + 1],[l + Nx],[l + 1 + Nx]))
                                                                                                                                                                                bendneighbours[indices,:]=cat(dot(4,ones(length(indices),1)),indices - 2,dot(- 1,ones(length(indices),1)),indices - dot(2,Nx),dot(- 1,ones(length(indices),1)),indices - dot(dot(2,Nx),Ny),indices + dot(dot(2,Nx),Ny))
                                                                                                                                                                            else:
                                                                                                                                                                                if 42 == typeintbounds[i,1]:
                                                                                                                                                                                    l=copy(index)
                                                                                                                                                                                    indices=matlabarray(cat([l],[l - 1],[l + Nx],[l - 1 + Nx]))
                                                                                                                                                                                    bendneighbours[indices,:]=cat(dot(4,ones(length(indices),1)),dot(- 1,ones(length(indices),1)),indices + 2,indices - dot(2,Nx),dot(- 1,ones(length(indices),1)),indices - dot(dot(2,Nx),Ny),indices + dot(dot(2,Nx),Ny))
                                                                                                                                                                                else:
                                                                                                                                                                                    if 43 == typeintbounds[i,1]:
                                                                                                                                                                                        l=copy(index)
                                                                                                                                                                                        indices=matlabarray(cat([l],[l + dot(Nx,Ny)],[l - Nx],[l - Nx + dot(Nx,Ny)]))
                                                                                                                                                                                        bendneighbours[indices,:]=cat(dot(4,ones(length(indices),1)),indices - 2,indices + 2,dot(- 1,ones(length(indices),1)),indices + dot(2,Nx),indices - dot(dot(2,Nx),Ny),dot(- 1,ones(length(indices),1)))
                                                                                                                                                                                    else:
                                                                                                                                                                                        if 44 == typeintbounds[i,1]:
                                                                                                                                                                                            l=copy(index)
                                                                                                                                                                                            indices=matlabarray(cat([l],[l + dot(Nx,Ny)],[l + 1],[l + 1 + dot(Nx,Ny)]))
                                                                                                                                                                                            bendneighbours[indices,:]=cat(dot(4,ones(length(indices),1)),indices - 2,dot(- 1,ones(length(indices),1)),indices - dot(2,Nx),indices + dot(2,Nx),indices - dot(dot(2,Nx),Ny),dot(- 1,ones(length(indices),1)))
                                                                                                                                                                                        else:
                                                                                                                                                                                            if 45 == typeintbounds[i,1]:
                                                                                                                                                                                                l=copy(index)
                                                                                                                                                                                                indices=matlabarray(cat([l],[l + dot(Nx,Ny)],[l + Nx],[l + Nx + dot(Nx,Ny)]))
                                                                                                                                                                                                bendneighbours[indices,:]=cat(dot(4,ones(length(indices),1)),indices - 2,indices + 2,indices - dot(2,Nx),dot(- 1,ones(length(indices),1)),indices - dot(dot(2,Nx),Ny),dot(- 1,ones(length(indices),1)))
                                                                                                                                                                                            else:
                                                                                                                                                                                                if 46 == typeintbounds[i,1]:
                                                                                                                                                                                                    l=copy(index)
                                                                                                                                                                                                    indices=matlabarray(cat([l],[l + dot(Nx,Ny)],[l - 1],[l - 1 + dot(Nx,Ny)]))
                                                                                                                                                                                                    bendneighbours[indices,:]=cat(dot(4,ones(length(indices),1)),dot(- 1,ones(length(indices),1)),indices + 2,indices - dot(2,Nx),indices + dot(2,Nx),indices - dot(dot(2,Nx),Ny),dot(- 1,ones(length(indices),1)))
    
    # ---> first derivatives neighbourhoods
    
    # integer mask for type of finite difference approximation (at 2nd order) for 1st derivative
# 1 --> central finite difference
# 2 --> one-sided finite difference with nodes on + side (missing on - side)
# 3 --> one-sided finite difference with nodes on - side (missing on + side)
    
    firstdevneighbours[indicesbulk,:]=cat(dot(1,ones(length(indicesbulk),1)),indicesbulk - 1,indicesbulk + 1,zeros(length(indicesbulk),1),dot(1,ones(length(indicesbulk),1)),indicesbulk - Nx,indicesbulk + Nx,zeros(length(indicesbulk),1),dot(1,ones(length(indicesbulk),1)),indicesbulk - dot(Nx,Ny),indicesbulk + dot(Nx,Ny),zeros(length(indicesbulk),1))
    firstdevneighbours[indicesF1,:]=cat(dot(1,ones(length(indicesF1),1)),indicesF1 - 1,indicesF1 + 1,zeros(length(indicesF1),1),dot(1,ones(length(indicesF1),1)),indicesF1 - Nx,indicesF1 + Nx,zeros(length(indicesF1),1),dot(2,ones(length(indicesF1),1)),indicesF1,indicesF1 + dot(Nx,Ny),indicesF1 + dot(dot(2,Nx),Ny))
    firstdevneighbours[indicesF2,:]=cat(dot(1,ones(length(indicesF2),1)),indicesF2 - 1,indicesF2 + 1,zeros(length(indicesF2),1),dot(2,ones(length(indicesF2),1)),indicesF2,indicesF2 + Nx,indicesF2 + dot(2,Nx),dot(1,ones(length(indicesF2),1)),indicesF2 - dot(Nx,Ny),indicesF2 + dot(Nx,Ny),zeros(length(indicesF2),1))
    firstdevneighbours[indicesF3,:]=cat(dot(3,ones(length(indicesF3),1)),indicesF3,indicesF3 - 1,indicesF3 - 2,dot(1,ones(length(indicesF3),1)),indicesF3 - Nx,indicesF3 + Nx,zeros(length(indicesF3),1),dot(1,ones(length(indicesF3),1)),indicesF3 - dot(Nx,Ny),indicesF3 + dot(Nx,Ny),zeros(length(indicesF3),1))
    firstdevneighbours[indicesF4,:]=cat(dot(1,ones(length(indicesF4),1)),indicesF4 - 1,indicesF4 + 1,zeros(length(indicesF4),1),dot(3,ones(length(indicesF4),1)),indicesF4,indicesF4 - Nx,indicesF4 - dot(2,Nx),dot(1,ones(length(indicesF4),1)),indicesF4 - dot(Nx,Ny),indicesF4 + dot(Nx,Ny),zeros(length(indicesF4),1))
    firstdevneighbours[indicesF5,:]=cat(dot(2,ones(length(indicesF5),1)),indicesF5,indicesF5 + 1,indicesF5 + 2,dot(1,ones(length(indicesF5),1)),indicesF5 - Nx,indicesF5 + Nx,zeros(length(indicesF5),1),dot(1,ones(length(indicesF5),1)),indicesF5 - dot(Nx,Ny),indicesF5 + dot(Nx,Ny),zeros(length(indicesF5),1))
    firstdevneighbours[indicesF6,:]=cat(dot(1,ones(length(indicesF6),1)),indicesF6 - 1,indicesF6 + 1,zeros(length(indicesF6),1),dot(1,ones(length(indicesF6),1)),indicesF6 - Nx,indicesF6 + Nx,zeros(length(indicesF6),1),dot(3,ones(length(indicesF6),1)),indicesF6,indicesF6 - dot(Nx,Ny),indicesF6 - dot(dot(2,Nx),Ny))
    firstdevneighbours[indicesE1,:]=cat(dot(1,ones(length(indicesE1),1)),indicesE1 - 1,indicesE1 + 1,zeros(length(indicesE1),1),dot(2,ones(length(indicesE1),1)),indicesE1,indicesE1 + Nx,indicesE1 + dot(2,Nx),dot(2,ones(length(indicesE1),1)),indicesE1,indicesE1 + dot(Nx,Ny),indicesE1 + dot(dot(2,Nx),Ny))
    firstdevneighbours[indicesE2,:]=cat(dot(3,ones(length(indicesE2),1)),indicesE2,indicesE2 - 1,indicesE2 - 2,dot(1,ones(length(indicesE2),1)),indicesE2 - Nx,indicesE2 + Nx,zeros(length(indicesE2),1),dot(2,ones(length(indicesE2),1)),indicesE2,indicesE2 + dot(Nx,Ny),indicesE2 + dot(dot(2,Nx),Ny))
    firstdevneighbours[indicesE3,:]=cat(dot(1,ones(length(indicesE3),1)),indicesE3 - 1,indicesE3 + 1,zeros(length(indicesE3),1),dot(3,ones(length(indicesE3),1)),indicesE3,indicesE3 - Nx,indicesE3 - dot(2,Nx),dot(2,ones(length(indicesE3),1)),indicesE3,indicesE3 + dot(Nx,Ny),indicesE3 + dot(dot(2,Nx),Ny))
    firstdevneighbours[indicesE4,:]=cat(dot(2,ones(length(indicesE4),1)),indicesE4,indicesE4 + 1,indicesE4 + 2,dot(1,ones(length(indicesE4),1)),indicesE4 - Nx,indicesE4 + Nx,zeros(length(indicesE4),1),dot(2,ones(length(indicesE4),1)),indicesE4,indicesE4 + dot(Nx,Ny),indicesE4 + dot(dot(2,Nx),Ny))
    firstdevneighbours[indicesE5,:]=cat(dot(2,ones(length(indicesE5),1)),indicesE5,indicesE5 + 1,indicesE5 + 2,dot(2,ones(length(indicesE5),1)),indicesE5,indicesE5 + Nx,indicesE5 + dot(2,Nx),dot(1,ones(length(indicesE5),1)),indicesE5 - dot(Nx,Ny),indicesE5 + dot(Nx,Ny),zeros(length(indicesE5),1))
    firstdevneighbours[indicesE6,:]=cat(dot(3,ones(length(indicesE6),1)),indicesE6,indicesE6 - 1,indicesE6 - 2,dot(2,ones(length(indicesE6),1)),indicesE6,indicesE6 + Nx,indicesE6 + dot(2,Nx),dot(1,ones(length(indicesE6),1)),indicesE6 - dot(Nx,Ny),indicesE6 + dot(Nx,Ny),zeros(length(indicesE6),1))
    firstdevneighbours[indicesE7,:]=cat(dot(3,ones(length(indicesE7),1)),indicesE7,indicesE7 - 1,indicesE7 - 2,dot(3,ones(length(indicesE7),1)),indicesE7,indicesE7 - Nx,indicesE7 - dot(2,Nx),dot(1,ones(length(indicesE7),1)),indicesE7 - dot(Nx,Ny),indicesE7 + dot(Nx,Ny),zeros(length(indicesE7),1))
    firstdevneighbours[indicesE8,:]=cat(dot(2,ones(length(indicesE8),1)),indicesE8,indicesE8 + 1,indicesE8 + 2,dot(3,ones(length(indicesE8),1)),indicesE8,indicesE8 - Nx,indicesE8 - dot(2,Nx),dot(1,ones(length(indicesE8),1)),indicesE8 - dot(Nx,Ny),indicesE8 + dot(Nx,Ny),zeros(length(indicesE8),1))
    firstdevneighbours[indicesE9,:]=cat(dot(1,ones(length(indicesE9),1)),indicesE9 - 1,indicesE9 + 1,zeros(length(indicesE9),1),dot(2,ones(length(indicesE9),1)),indicesE9,indicesE9 + Nx,indicesE9 + dot(2,Nx),dot(3,ones(length(indicesE9),1)),indicesE9,indicesE9 - dot(Nx,Ny),indicesE9 - dot(dot(2,Nx),Ny))
    firstdevneighbours[indicesE10,:]=cat(dot(3,ones(length(indicesE10),1)),indicesE10,indicesE10 - 1,indicesE10 - 2,dot(1,ones(length(indicesE10),1)),indicesE10 - Nx,indicesE10 + Nx,zeros(length(indicesE10),1),dot(3,ones(length(indicesE10),1)),indicesE10,indicesE10 - dot(Nx,Ny),indicesE10 - dot(dot(2,Nx),Ny))
    firstdevneighbours[indicesE11,:]=cat(dot(1,ones(length(indicesE11),1)),indicesE11 - 1,indicesE11 + 1,zeros(length(indicesE11),1),dot(3,ones(length(indicesE11),1)),indicesE11,indicesE11 - Nx,indicesE11 - dot(2,Nx),dot(3,ones(length(indicesE11),1)),indicesE11,indicesE11 - dot(Nx,Ny),indicesE11 - dot(dot(2,Nx),Ny))
    firstdevneighbours[indicesE12,:]=cat(dot(2,ones(length(indicesE12),1)),indicesE12,indicesE12 + 1,indicesE12 + 2,dot(1,ones(length(indicesE12),1)),indicesE12 - Nx,indicesE12 + Nx,zeros(length(indicesE12),1),dot(3,ones(length(indicesE12),1)),indicesE12,indicesE12 - dot(Nx,Ny),indicesE12 - dot(dot(2,Nx),Ny))
    firstdevneighbours[indicesC1,:]=cat(dot(2,ones(length(indicesC1),1)),indicesC1,indicesC1 + 1,indicesC1 + 2,dot(2,ones(length(indicesC1),1)),indicesC1,indicesC1 + Nx,indicesC1 + dot(2,Nx),dot(2,ones(length(indicesC1),1)),indicesC1,indicesC1 + dot(Nx,Ny),indicesC1 + dot(dot(2,Nx),Ny))
    firstdevneighbours[indicesC2,:]=cat(dot(3,ones(length(indicesC2),1)),indicesC2,indicesC2 - 1,indicesC2 - 2,dot(2,ones(length(indicesC2),1)),indicesC2,indicesC2 + Nx,indicesC2 + dot(2,Nx),dot(2,ones(length(indicesC1),1)),indicesC2,indicesC2 + dot(Nx,Ny),indicesC2 + dot(dot(2,Nx),Ny))
    firstdevneighbours[indicesC3,:]=cat(dot(3,ones(length(indicesC3),1)),indicesC3,indicesC3 - 1,indicesC3 - 2,dot(3,ones(length(indicesC3),1)),indicesC3,indicesC3 - Nx,indicesC3 - dot(2,Nx),dot(2,ones(length(indicesC1),1)),indicesC3,indicesC3 + dot(Nx,Ny),indicesC3 + dot(dot(2,Nx),Ny))
    firstdevneighbours[indicesC4,:]=cat(dot(2,ones(length(indicesC4),1)),indicesC4,indicesC4 + 1,indicesC4 + 2,dot(3,ones(length(indicesC4),1)),indicesC4,indicesC4 - Nx,indicesC4 - dot(2,Nx),dot(2,ones(length(indicesC1),1)),indicesC4,indicesC4 + dot(Nx,Ny),indicesC4 + dot(dot(2,Nx),Ny))
    firstdevneighbours[indicesC5,:]=cat(dot(2,ones(length(indicesC5),1)),indicesC5,indicesC5 + 1,indicesC5 + 2,dot(2,ones(length(indicesC5),1)),indicesC5,indicesC5 + Nx,indicesC5 + dot(2,Nx),dot(3,ones(length(indicesC1),1)),indicesC5,indicesC5 - dot(Nx,Ny),indicesC5 - dot(dot(2,Nx),Ny))
    firstdevneighbours[indicesC6,:]=cat(dot(3,ones(length(indicesC6),1)),indicesC6,indicesC6 - 1,indicesC6 - 2,dot(2,ones(length(indicesC6),1)),indicesC6,indicesC6 + Nx,indicesC6 + dot(2,Nx),dot(3,ones(length(indicesC1),1)),indicesC6,indicesC6 - dot(Nx,Ny),indicesC6 - dot(dot(2,Nx),Ny))
    firstdevneighbours[indicesC7,:]=cat(dot(3,ones(length(indicesC7),1)),indicesC7,indicesC7 - 1,indicesC7 - 2,dot(3,ones(length(indicesC7),1)),indicesC7,indicesC7 - Nx,indicesC7 - dot(2,Nx),dot(3,ones(length(indicesC1),1)),indicesC7,indicesC7 - dot(Nx,Ny),indicesC7 - dot(dot(2,Nx),Ny))
    firstdevneighbours[indicesC8,:]=cat(dot(2,ones(length(indicesC8),1)),indicesC8,indicesC8 + 1,indicesC8 + 2,dot(3,ones(length(indicesC8),1)),indicesC8,indicesC8 - Nx,indicesC8 - dot(2,Nx),dot(3,ones(length(indicesC1),1)),indicesC8,indicesC8 - dot(Nx,Ny),indicesC8 - dot(dot(2,Nx),Ny))
    if flagintbounds:
        for i in arange(1,size(indicesintbounds,1)).reshape(-1):
            index=indicesintbounds[i,1]
            if 1 == typeintbounds[i,1]:
                firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,1,index - Nx,index + Nx,0,1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
            else:
                if 2 == typeintbounds[i,1]:
                    firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,1,index - Nx,index + Nx,0,1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                else:
                    if 3 == typeintbounds[i,1]:
                        firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,1,index - Nx,index + Nx,0,1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                    else:
                        if 4 == typeintbounds[i,1]:
                            firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,1,index - Nx,index + Nx,0,1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                        else:
                            if 5 == typeintbounds[i,1]:
                                firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,1,index - Nx,index + Nx,0,1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                            else:
                                if 6 == typeintbounds[i,1]:
                                    firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,1,index - Nx,index + Nx,0,1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                                else:
                                    if 7 == typeintbounds[i,1]:
                                        firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,1,index - Nx,index + Nx,0,1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                                    else:
                                        if 8 == typeintbounds[i,1]:
                                            firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,1,index - Nx,index + Nx,0,1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                                        else:
                                            if 9 == typeintbounds[i,1]:
                                                firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,1,index - Nx,index + Nx,0,1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                                            else:
                                                if 10 == typeintbounds[i,1]:
                                                    firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,1,index - Nx,index + Nx,0,1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                                                else:
                                                    if 11 == typeintbounds[i,1]:
                                                        firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,1,index - Nx,index + Nx,0,1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                                                    else:
                                                        if 12 == typeintbounds[i,1]:
                                                            firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,1,index - Nx,index + Nx,0,1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                                                        else:
                                                            if 13 == typeintbounds[i,1]:
                                                                firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,1,index - Nx,index + Nx,0,1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                                                            else:
                                                                if 14 == typeintbounds[i,1]:
                                                                    firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,1,index - Nx,index + Nx,0,1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                                                                else:
                                                                    if 15 == typeintbounds[i,1]:
                                                                        firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,1,index - Nx,index + Nx,0,1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                                                                    else:
                                                                        if 16 == typeintbounds[i,1]:
                                                                            firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,1,index - Nx,index + Nx,0,1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                                                                        else:
                                                                            if 17 == typeintbounds[i,1]:
                                                                                firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,1,index - Nx,index + Nx,0,1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                                                                            else:
                                                                                if 18 == typeintbounds[i,1]:
                                                                                    firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,1,index - Nx,index + Nx,0,1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                                                                                else:
                                                                                    if 19 == typeintbounds[i,1]:
                                                                                        firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,1,index - Nx,index + Nx,0,1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                                                                                    else:
                                                                                        if 20 == typeintbounds[i,1]:
                                                                                            firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,1,index - Nx,index + Nx,0,1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                                                                                        else:
                                                                                            if 21 == typeintbounds[i,1]:
                                                                                                firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,1,index - Nx,index + Nx,0,2,index,index + dot(Nx,Ny),index + dot(dot(2,Nx),Ny))
                                                                                            else:
                                                                                                if 22 == typeintbounds[i,1]:
                                                                                                    firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,2,index,index + Nx,index + dot(2,Nx),1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                                                                                                else:
                                                                                                    if 23 == typeintbounds[i,1]:
                                                                                                        firstdevneighbours[index,:]=cat(3,index,index - 1,index - 2,1,index - Nx,index + Nx,0,1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                                                                                                    else:
                                                                                                        if 24 == typeintbounds[i,1]:
                                                                                                            firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,3,index,index - Nx,index - dot(2,Nx),1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                                                                                                        else:
                                                                                                            if 25 == typeintbounds[i,1]:
                                                                                                                firstdevneighbours[index,:]=cat(2,index,index + 1,index + 2,1,index - Nx,index + Nx,0,1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                                                                                                            else:
                                                                                                                if 26 == typeintbounds[i,1]:
                                                                                                                    firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,1,index - Nx,index + Nx,0,3,index,index - dot(Nx,Ny),index - dot(dot(2,Nx),Ny))
                                                                                                                else:
                                                                                                                    if 27 == typeintbounds[i,1]:
                                                                                                                        firstdevneighbours[index,:]=cat(2,index,index + 1,index + 2,2,index,index + Nx,index + dot(2,Nx),2,index,index + dot(Nx,Ny),index + dot(dot(2,Nx),Ny))
                                                                                                                    else:
                                                                                                                        if 28 == typeintbounds[i,1]:
                                                                                                                            firstdevneighbours[index,:]=cat(3,index,index - 1,index - 2,2,index,index + Nx,index + dot(2,Nx),2,index,index + dot(Nx,Ny),index + dot(dot(2,Nx),Ny))
                                                                                                                        else:
                                                                                                                            if 29 == typeintbounds[i,1]:
                                                                                                                                firstdevneighbours[index,:]=cat(3,index,index - 1,index - 2,3,index,index - Nx,index - dot(2,Nx),2,index,index + dot(Nx,Ny),index + dot(dot(2,Nx),Ny))
                                                                                                                            else:
                                                                                                                                if 30 == typeintbounds[i,1]:
                                                                                                                                    firstdevneighbours[index,:]=cat(2,index,index + 1,index + 2,3,index,index - Nx,index - dot(2,Nx),2,index,index + dot(Nx,Ny),index + dot(dot(2,Nx),Ny))
                                                                                                                                else:
                                                                                                                                    if 31 == typeintbounds[i,1]:
                                                                                                                                        firstdevneighbours[index,:]=cat(2,index,index + 1,index + 2,2,index,index + Nx,index + dot(2,Nx),3,index,index - dot(Nx,Ny),index - dot(dot(2,Nx),Ny))
                                                                                                                                    else:
                                                                                                                                        if 32 == typeintbounds[i,1]:
                                                                                                                                            firstdevneighbours[index,:]=cat(3,index,index - 1,index - 2,2,index,index + Nx,index + dot(2,Nx),3,index,index - dot(Nx,Ny),index - dot(dot(2,Nx),Ny))
                                                                                                                                        else:
                                                                                                                                            if 33 == typeintbounds[i,1]:
                                                                                                                                                firstdevneighbours[index,:]=cat(3,index,index - 1,index - 2,3,index,index - Nx,index - dot(2,Nx),3,index,index - dot(Nx,Ny),index - dot(dot(2,Nx),Ny))
                                                                                                                                            else:
                                                                                                                                                if 34 == typeintbounds[i,1]:
                                                                                                                                                    firstdevneighbours[index,:]=cat(2,index,index + 1,index + 2,3,index,index - Nx,index - dot(2,Nx),3,index,index - dot(Nx,Ny),index - dot(dot(2,Nx),Ny))
                                                                                                                                                else:
                                                                                                                                                    if 35 == typeintbounds[i,1]:
                                                                                                                                                        firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,2,index,index + Nx,index + dot(2,Nx),2,index,index + dot(Nx,Ny),index + dot(dot(2,Nx),Ny))
                                                                                                                                                    else:
                                                                                                                                                        if 36 == typeintbounds[i,1]:
                                                                                                                                                            firstdevneighbours[index,:]=cat(3,index,index - 1,index - 2,1,index - Nx,index + Nx,0,2,index,index + dot(Nx,Ny),index + dot(dot(2,Nx),Ny))
                                                                                                                                                        else:
                                                                                                                                                            if 37 == typeintbounds[i,1]:
                                                                                                                                                                firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,3,index,index - Nx,index - dot(2,Nx),2,index,index + dot(Nx,Ny),index + dot(dot(2,Nx),Ny))
                                                                                                                                                            else:
                                                                                                                                                                if 38 == typeintbounds[i,1]:
                                                                                                                                                                    firstdevneighbours[index,:]=cat(2,index,index + 1,index + 2,1,index - Nx,index + Nx,0,2,index,index + dot(Nx,Ny),index + dot(dot(2,Nx),Ny))
                                                                                                                                                                else:
                                                                                                                                                                    if 39 == typeintbounds[i,1]:
                                                                                                                                                                        firstdevneighbours[index,:]=cat(2,index,index + 1,index + 2,2,index,index + Nx,index + dot(2,Nx),1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                                                                                                                                                                    else:
                                                                                                                                                                        if 40 == typeintbounds[i,1]:
                                                                                                                                                                            firstdevneighbours[index,:]=cat(3,index,index - 1,index - 2,2,index,index + Nx,index + dot(2,Nx),1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                                                                                                                                                                        else:
                                                                                                                                                                            if 41 == typeintbounds[i,1]:
                                                                                                                                                                                firstdevneighbours[index,:]=cat(3,index,index - 1,index - 2,3,index,index - Nx,index - dot(2,Nx),1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                                                                                                                                                                            else:
                                                                                                                                                                                if 42 == typeintbounds[i,1]:
                                                                                                                                                                                    firstdevneighbours[index,:]=cat(2,index,index + 1,index + 2,3,index,index - Nx,index - dot(2,Nx),1,index - dot(Nx,Ny),index + dot(Nx,Ny),0)
                                                                                                                                                                                else:
                                                                                                                                                                                    if 43 == typeintbounds[i,1]:
                                                                                                                                                                                        firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,2,index,index + Nx,index + dot(2,Nx),3,index,index - dot(Nx,Ny),index - dot(dot(2,Nx),Ny))
                                                                                                                                                                                    else:
                                                                                                                                                                                        if 44 == typeintbounds[i,1]:
                                                                                                                                                                                            firstdevneighbours[index,:]=cat(3,index,index - 1,index - 2,1,index - Nx,index + Nx,0,3,index,index - dot(Nx,Ny),index - dot(dot(2,Nx),Ny))
                                                                                                                                                                                        else:
                                                                                                                                                                                            if 45 == typeintbounds[i,1]:
                                                                                                                                                                                                firstdevneighbours[index,:]=cat(1,index - 1,index + 1,0,3,index,index - Nx,index - dot(2,Nx),3,index,index - dot(Nx,Ny),index - dot(dot(2,Nx),Ny))
                                                                                                                                                                                            else:
                                                                                                                                                                                                if 46 == typeintbounds[i,1]:
                                                                                                                                                                                                    firstdevneighbours[index,:]=cat(2,index,index + 1,index + 2,1,index - Nx,index + Nx,0,3,index,index - dot(Nx,Ny),index - dot(dot(2,Nx),Ny))
    
    return structuralneighbours,shearneighbours,bendneighbours,firstdevneighbours